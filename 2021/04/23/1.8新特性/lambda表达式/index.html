<!DOCTYPE html>


<html lang="en">


<head>
  <meta charset="utf-8" />
    
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>
    Lambda表达式 |  WinGone&#39;s Blog
  </title>
  <meta name="generator" content="hexo-theme-ayer">
  
  <link rel="shortcut icon" href="/favicon.ico" />
  
  
<link rel="stylesheet" href="/dist/main.css">

  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/css/remixicon.min.css">

  
<link rel="stylesheet" href="/css/custom.css">

  
  
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

  
  

  

<link rel="alternate" href="/atom.xml" title="WinGone's Blog" type="application/atom+xml">
</head>

</html>

<body>
  <div id="app">
    
      <canvas class="fireworks"></canvas>
      <style>
        .fireworks {
          position: fixed;
          left: 0;
          top: 0;
          z-index: 99999;
          pointer-events: none;
        }
      </style>
      
      
    <main class="content on">
      <section class="outer">
  <article
  id="Lambda表达式-1.8新特性/lambda表达式"
  class="article article-type-Lambda表达式"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  Lambda表达式
</h1>
 

    </header>
     
    <div class="article-meta">
      <a href="/2021/04/23/1.8%E6%96%B0%E7%89%B9%E6%80%A7/lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/" class="article-date">
  <time datetime="2021-04-23T04:48:33.000Z" itemprop="datePublished">2021-04-23</time>
</a>   
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> Word count:</span>
            <span class="post-count">7.3k</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> Reading time≈</span>
            <span class="post-count">31 min</span>
        </span>
    </span>
</div>
 
    </div>
      
    <div class="tocbot"></div>




  
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="（一）、初识Lambda"><a href="#（一）、初识Lambda" class="headerlink" title="（一）、初识Lambda"></a>（一）、初识Lambda</h1><h3 id="什么是Lambda表达式"><a href="#什么是Lambda表达式" class="headerlink" title="什么是Lambda表达式"></a>什么是Lambda表达式</h3><p>Lambda表达式是表示可传递匿名函数的一种简洁方式，Lambda表达式没有名称，但是有参数列表、函数主体、返回类型，还可能有一个可以抛出的异常列表。它是Java8新增的特性，有了它我们再也不用像之前那样写一堆笨重的匿名类代码了，我们先来体验一下。</p>
<h3 id="与匿名函数对比"><a href="#与匿名函数对比" class="headerlink" title="与匿名函数对比"></a>与匿名函数对比</h3><p>下面我们先举个例子，有这样一个表示<strong>口罩</strong>的类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> one.more.study;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 口罩</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Mask</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 品牌</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String brand;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 类型</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String type;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getBrand</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> brand;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBrand</span><span class="params">(String brand)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.brand = brand;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> type;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setType</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.type = type;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>再创建一个口罩列表，添加一些口罩对象：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Mask&gt; maskList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">maskList.add(<span class="keyword">new</span> Mask(<span class="string">&quot;3M&quot;</span>, <span class="string">&quot;KN95&quot;</span>));</span><br><span class="line">maskList.add(<span class="keyword">new</span> Mask(<span class="string">&quot;3M&quot;</span>, <span class="string">&quot;FFP2&quot;</span>));</span><br><span class="line">maskList.add(<span class="keyword">new</span> Mask(<span class="string">&quot;Honeywell&quot;</span>, <span class="string">&quot;KN95&quot;</span>));</span><br><span class="line">maskList.add(<span class="keyword">new</span> Mask(<span class="string">&quot;Honeywell&quot;</span>, <span class="string">&quot;N95&quot;</span>));</span><br></pre></td></tr></table></figure>

<p>现在我们按照品牌给这个口罩列表进行排序。在Java8之前，我们可以用匿名函数进行实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">maskList.sort(<span class="keyword">new</span> Comparator&lt;Mask&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Mask o1, Mask o2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> o1.getBrand().compareTo(o2.getBrand());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>我们再使用Lambda表达式实现一下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">maskList.sort((Mask o1, Mask o2) -&gt; o1.getBrand().compareTo(o2.getBrand()));</span><br></pre></td></tr></table></figure>

<p>显而易见，使用Lambda表达式以后，代码看起来更清晰更简洁了。假如你还是一脸懵圈的话也没关系，这里我只是想显摆一下Lambda表达式很牛掰，接下来我会一点点地详细讲解清楚。</p>
<h3 id="Lambda表达式的组成"><a href="#Lambda表达式的组成" class="headerlink" title="Lambda表达式的组成"></a>Lambda表达式的组成</h3><p>Lambda表达式由三部分组成，以上面的口罩排序的例子为例，如下图：<br><img src="/2021/04/23/1.8%E6%96%B0%E7%89%B9%E6%80%A7/lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/1.png" alt="img"></p>
<ol>
<li><strong>参数列表</strong>：本例中是两个<code>Mask</code>对象的参数，采用的是Comparator接口中compare方法的参数。</li>
<li><strong>箭头</strong>：<code>-&gt;</code>把参数列表和主体分隔为两个部分。</li>
<li><strong>主体</strong>：本例中是把比较口罩品牌的表达式作为Lambda表达式的返回。主体可以修改成另外一种写法，含义是一样的：</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">maskList.sort((Mask o1, Mask o2) -&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> o1.getBrand().compareTo(o2.getBrand());</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Lambda表达式的基本语法"><a href="#Lambda表达式的基本语法" class="headerlink" title="Lambda表达式的基本语法"></a>Lambda表达式的基本语法</h3><p>从上面的例子中的两个种写法中，可以看出Lambda表达式有两种基本语法，分别如下：</p>
<ol>
<li>(参数列表) <code>-&gt;</code> 表达式</li>
<li>(参数列表) <code>-&gt;</code> { 多条语句 }</li>
</ol>
<p>只看这两条干瘪的语法，理解起来比较困难，实践出真知，我们来多举几个例子。</p>
<h3 id="Lambda表达式示例"><a href="#Lambda表达式示例" class="headerlink" title="Lambda表达式示例"></a>Lambda表达式示例</h3><ol>
<li>我们提到的例子，Lambda表达式的参数列表有两个Mask类型的参数，主体是比较两个Mask对象的品牌，返回的是一个int类型。<strong>当主体是一个表达式时，不需要return语句，隐含return该表达式的返回值。</strong></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(Mask o1, Mask o2) -&gt; o1.getBrand().compareTo(o2.getBrand())</span><br></pre></td></tr></table></figure>

<ol>
<li>参数列表中仅有一个Mask类型的参数，返回的是一个String类型，是该Mask对象的品牌信息。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(Mask mask) -&gt; mask.getBrand()</span><br></pre></td></tr></table></figure>

<ol>
<li>参数列表中仅有一个Mask类型的参数，返回的是一个boolean类型，是该Mask对象的类型是否为N95。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(Mask mask) -&gt; mask.getType() == <span class="string">&quot;N95&quot;</span></span><br></pre></td></tr></table></figure>

<ol>
<li>参数列表中没有任何参数，返回的是一个int类型。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">() -&gt; <span class="number">996</span></span><br></pre></td></tr></table></figure>

<ol>
<li>参数列表中有两个int类型的参数，但是没有返回值（void）。<strong>在主体中可以写多条语句，不过记住要用<code>&#123;</code>和<code>&#125;</code>将其包裹。</strong></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">int</span> x, <span class="keyword">int</span> y) -&gt; &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;万猫学社想对你说：&quot;</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;第一个参数是：&quot;</span> + x);</span><br><span class="line">    System.out.println(<span class="string">&quot;第二个参数是：&quot;</span> + y);</span><br><span class="line">    System.out.println(<span class="string">&quot;两数之和是：&quot;</span> + (x + y));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="小测试"><a href="#小测试" class="headerlink" title="小测试"></a>小测试</h3><p>看了这么多的例子，是不是撸胳膊挽袖子准备大干一场？别急，检验出真知，我们先简单测试一下。以下的Lambda表达式有哪几个是正确的？</p>
<ol>
<li><code>() -&gt; &#123;&#125;</code></li>
<li><code>() -&gt; &quot;万猫学社&quot;</code></li>
<li><code>() -&gt; &#123; &quot;万猫学社&quot; &#125;</code></li>
<li><code>() -&gt; &#123; return &quot;万猫学社&quot;; &#125;</code></li>
<li><code>() -&gt; return &quot;万猫学社&quot;;</code></li>
</ol>
<p>请思考片刻…<br>.<br>.<br>.<br><img src="/2021/04/23/1.8%E6%96%B0%E7%89%B9%E6%80%A7/lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/2.jpg" alt="img"><br>.<br>.<br>.</p>
<p><strong>宣布答案</strong>：第1、2和4个是正确的，第3和5个是错误的。我们来逐个分析一下：</p>
<ol>
<li><code>() -&gt; &#123;&#125;</code>：正确，这个Lambda表达式没有参数，也没有任何返回。</li>
<li><code>() -&gt; &quot;万猫学社&quot;</code>：正确，这个Lambda表达式没有参数，主体是一个表达式，返回String类型。</li>
<li><code>() -&gt; &#123; &quot;万猫学社&quot; &#125;</code>：错误，<code>&quot;万猫学社&quot;</code>是一个表达式，不是一个语句，不能使用<code>&#123;</code>和<code>&#125;</code>将其包裹，可以修改为<code>() -&gt; &quot;万猫学社&quot;</code>。</li>
<li><code>() -&gt; &#123; return &quot;万猫学社&quot;; &#125;</code>：正确，这个Lambda表达式没有参数，主体是一个语句，使用<code>&#123;</code>和<code>&#125;</code>将其包裹，返回String类型。</li>
<li><code>() -&gt; return &quot;万猫学社&quot;;</code>：错误，<code>return &quot;万猫学社&quot;;</code>是一个语句，不是一个表达式，必须使用<code>&#123;</code>和<code>&#125;</code>将其包裹，可以修改为<code>() -&gt; &#123; return &quot;万猫学社&quot;; &#125;</code>。</li>
</ol>
<p>如果你全部答对，恭喜你，你已经基本掌握Lambda表达式的基本语法；如果你有答错的，没关系，重新再看一遍，再复习巩固一下。<br>学习的路上，我与你一起前行。</p>
<h1 id="（二）：Lambda的使用"><a href="#（二）：Lambda的使用" class="headerlink" title="（二）：Lambda的使用"></a>（二）：Lambda的使用</h1><h3 id="在哪使用Lambda表达式？"><a href="#在哪使用Lambda表达式？" class="headerlink" title="在哪使用Lambda表达式？"></a>在哪使用Lambda表达式？</h3><p>在上一篇文章（<a target="_blank" rel="noopener" href="https://blog.csdn.net/heihaozi/article/details/104203328">传送门</a>）中介绍了Lambda表达式的基本语法，其中的举了一个Lambda表达式的例子，就是按照品牌给口罩列表进行排序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">maskList.sort((Mask o1, Mask o2) -&gt; o1.getBrand().compareTo(o2.getBrand()));</span><br></pre></td></tr></table></figure>

<p>这里使用的<code>sort</code>方法的参数类型是<code>Comparator&lt;T&gt;</code>，我们就是把Lambda表达式作为<code>Comparator&lt;T&gt;</code>传入<code>sort</code>方法中的。<code>Comparator&lt;T&gt;</code>就是一个函数式接口，那么什么是函数式接口？</p>
<h3 id="函数式接口"><a href="#函数式接口" class="headerlink" title="函数式接口"></a>函数式接口</h3><p>函数式接口就是有且仅有一个抽象方法的接口。上面提到的<code>Comparator&lt;T&gt;</code>接口，虽然有很多默认方法，但有且仅有一个抽象方法<code>compare</code>，所以它仍然是一个函数式接口。再举一个例子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> java.util.concurrent;</span><br><span class="line"></span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Callable</span>&lt;<span class="title">V</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function">V <span class="title">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>Callable</code>接口只有一个<code>call</code>抽象方法，所以它也是函数式接口。</p>
<p>你可以已经发现了，<code>Callable</code>接口上有一个注解<code>@FunctionalInterface</code>，该注解用于标志该接口是一个函数式接口。如果你编写了一个不是函数式接口的接口，并且加了<code>@FunctionalInterface</code>注解，编译就会报错，需要注意一下。</p>
<p>看了以上的例子，是不是撸胳膊挽袖子准备大干一场？别急，检验出真知，我们先简单测试一下。以下三个接口，哪些是函数式接口，哪些不是函数式接口？</p>
<ol>
<li>Runnable</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> java.lang;</span><br><span class="line"></span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>Task</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sun.jmx.snmp.tasks;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Task</span> <span class="keyword">extends</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">cancel</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>Serializable</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> java.io;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>请思考片刻…<br>.<br>.<br>.<br><img src="/2021/04/23/1.8%E6%96%B0%E7%89%B9%E6%80%A7/lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/2.jpg" alt="img"><br>.<br>.<br>.<br><strong>宣布答案</strong>：</p>
<ol>
<li><code>Runnable</code>只有一个抽象方法<code>run</code>，所以是函数式接口</li>
<li><code>Task</code>有两个抽象方法，分别是自己的<code>cancel</code>方法和从<code>Runnable</code>继承而来的<code>run</code>方法，所以不是函数式接口。</li>
<li><code>Serializable</code>没有任何一个方法，所以不是函数式接口。</li>
</ol>
<p>怎么样？都答对了嘛？</p>
<h3 id="实现函数式接口"><a href="#实现函数式接口" class="headerlink" title="实现函数式接口"></a>实现函数式接口</h3><p>了解了什么是函数式接口以后，我们就可以直接使用Lambda表达式为函数式接口提供实现了，并且还可以把整个Lambda表达式作为函数式接口的实例。比如上面提到的<code>Runnable</code>接口，我们就是这样直接赋值：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Runnable runnable = () -&gt; &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;万猫学社&quot;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>到目前为止，我们已经知道在哪使用Lambda表达式，那么该如何正确的使用Lambda表达式呢？</p>
<h3 id="怎么使用Lambda表达式？"><a href="#怎么使用Lambda表达式？" class="headerlink" title="怎么使用Lambda表达式？"></a>怎么使用Lambda表达式？</h3><p>从上面<code>Runnable</code>接口实例的例子中，可以看出：<code>Runnable</code>接口的<code>run</code>方法没有入参没有返回，该方法的签名是<code>() -&gt; void</code>；Lambda表达式同样的也没有入参没有返回，该表达式的签名是<code>() -&gt; void</code>。</p>
<p>也就是说：<strong>函数式接口的抽象方法的签名和Lambda表达式的签名必须一致。</strong></p>
<p>再比如，按照品牌给口罩列表进行排序的例子，<code>Comparator&lt;T&gt;</code>接口的<code>compare</code>方法的签名是<code>(T ,T) -&gt; int</code>,Lambda表达式的签名同样也是<code>(T ,T) -&gt; int</code>。</p>
<p>为了加深理解，我们再来做个小测试，看看哪些代码正确使用了Lambda表达式？</p>
<ol>
<li><code>Callable</code></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Callable&lt;String&gt; callable = () -&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;万猫学社&quot;</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ol>
<li><code>Runnable</code></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Runnable runnable = () -&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;万猫学社&quot;</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ol>
<li><code>Comparator&lt;Mask&gt;</code></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">maskList.sort((Mask o1, Mask o2) -&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (o1.getBrand().equals(o2.getBrand())) &#123;</span><br><span class="line">        <span class="keyword">return</span> o1.getType().compareTo(o2.getType());</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> o1.getBrand().compareTo(o2.getBrand());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>请思考片刻…<br>.<br>.<br>.<br><img src="/2021/04/23/1.8%E6%96%B0%E7%89%B9%E6%80%A7/lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/2.jpg" alt="img"><br>.<br>.<br>.<br><strong>宣布答案</strong>：</p>
<ol>
<li><code>Callable</code>：正确，Lambda表达式的签名是<code>() -&gt; String</code>，与<code>Callable&lt;String&gt;</code>接口的唯一抽象方法<code>call</code>的签名匹配，所以是正确的。</li>
<li><code>Runnable</code>：错误，Lambda表达式的签名是<code>() -&gt; String</code>，但是<code>Runnable</code>接口的唯一抽象方法<code>run</code>的签名是<code>() -&gt; void</code>，两者不匹配，所以是错误的。</li>
<li><code>Comparator&lt;Mask&gt;</code>:正确，Lambda表达式的签名是<code>(Mask, Mask) -&gt; int</code>，与<code>Comparator&lt;Mask&gt;</code>接口的唯一抽象方法<code>compare</code>的签名匹配，所以是正确的。</li>
</ol>
<p>怎么样？都答对了嘛？</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>有且仅有一个抽象方法的接口叫做<strong>函数式接口</strong>，Lambda表达式可以直接作为函数式接口的实例，函数式接口的抽象方法的签名和Lambda表达式的签名必须一致。</p>
<h1 id="（三）：更简洁的Lambda"><a href="#（三）：更简洁的Lambda" class="headerlink" title="（三）：更简洁的Lambda"></a>（三）：更简洁的Lambda</h1><h3 id="类型推断"><a href="#类型推断" class="headerlink" title="类型推断"></a>类型推断</h3><p>编译器可以通过函数式接口推断出Lambda表达式的参数类型，所以在编写Lambda表达式时，可以省略参数类型。比如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Comparator&lt;Mask&gt; comparator = (Mask o1, Mask o2) -&gt; o1.getBrand().compareTo(o2.getBrand());</span><br></pre></td></tr></table></figure>

<p>就可以简写为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Comparator&lt;Mask&gt; comparator = (o1, o2) -&gt; o1.getBrand().compareTo(o2.getBrand());</span><br></pre></td></tr></table></figure>

<p>另外，当Lambda表达式只有一个参数的时候，不仅可以省略参数类型，还可以省略到参数名称两边的括号，比如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Predicate&lt;Mask&gt; predicate = (Mask mask) -&gt; mask.getType() == <span class="string">&quot;N95&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>就可以简写为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Predicate&lt;Mask&gt; predicate = mask -&gt; mask.getType() == <span class="string">&quot;N95&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="方法引用"><a href="#方法引用" class="headerlink" title="方法引用"></a>方法引用</h3><h4 id="什么是方法引用？"><a href="#什么是方法引用？" class="headerlink" title="什么是方法引用？"></a>什么是方法引用？</h4><p>方法引用是Java8中引入的新特性，它提供了一种引用方法而不执行方法的方式，可以让我们重复使用现用方法的定义，做为某些Lambda表达式的另一种更简洁的写法。</p>
<p>比如前面的例子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Comparator&lt;Mask&gt; comparator = (o1, o2) -&gt; o1.getBrand().compareTo(o2.getBrand());</span><br></pre></td></tr></table></figure>

<p>使用方法引用以后，可以简写为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Comparator&lt;Mask&gt; comparator = Comparator.comparing(Mask::getBrand);</span><br></pre></td></tr></table></figure>

<p>当你需要方法引用时，目标引用放在分隔符<code>::</code>前，方法的名称放在分隔符<code>::</code>后。比如，上面的<code>Mask::getBrand</code>，就是引用了<code>Mask</code>中定义的<code>getBrand</code>方法。方法名称后不需要加括号，因为我们并没有实际调用它。方法引用提高了代码的可读性，也使逻辑更加清晰。</p>
<h4 id="怎么构建方法引用？"><a href="#怎么构建方法引用？" class="headerlink" title="怎么构建方法引用？"></a>怎么构建方法引用？</h4><p>可以构建方法引用的场景的有四种：</p>
<h5 id="1-静态方法"><a href="#1-静态方法" class="headerlink" title="1. 静态方法"></a>1. 静态方法</h5><p>指向静态方法的引用，语法：<code>类名::静态方法名</code>，类名放在分隔符<code>::</code>前，:静态方法名放在分隔符<code>::</code>后。比如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(String str) -&gt; Integer.parseInt(str)</span><br></pre></td></tr></table></figure>

<p>使用方法引用以后，可以简写为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Integer::parseInt</span><br></pre></td></tr></table></figure>

<h5 id="2-内部对象的实例方法"><a href="#2-内部对象的实例方法" class="headerlink" title="2. 内部对象的实例方法"></a>2. 内部对象的实例方法</h5><p>指向Lambda表达式内部对象的实例方法的引用，语法：<code>类名::实例方法名</code>，类名放在分隔符<code>::</code>前，:实例方法名放在分隔符<code>::</code>后。比如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(Mask mask) -&gt; mask.getBrand()</span><br></pre></td></tr></table></figure>

<p>使用方法引用以后，可以简写为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Mask::getBrand</span><br></pre></td></tr></table></figure>

<h5 id="3-外部对象的实例方法"><a href="#3-外部对象的实例方法" class="headerlink" title="3. 外部对象的实例方法"></a>3. 外部对象的实例方法</h5><p>指向Lambda表达式外部对象的实例方法的引用，语法：<code>实例名::实例方法名</code>，类名放在分隔符<code>::</code>前，:实例方法名放在分隔符<code>::</code>后。比如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String type = <span class="string">&quot;N95&quot;</span>;</span><br><span class="line">Predicate&lt;String&gt; predicate = (String str) -&gt; type.equals(str);</span><br><span class="line">System.out.println(predicate.test(<span class="string">&quot;N95&quot;</span>));</span><br><span class="line"><span class="number">123</span></span><br></pre></td></tr></table></figure>

<p>其中，<code>type</code>是一个Lambda表达式外部的局部变量，使用方法引用以后，可以简写为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">String type = <span class="string">&quot;N95&quot;</span>;</span><br><span class="line">Predicate&lt;String&gt; predicate = type::equals;</span><br><span class="line">System.out.println(predicate.test(<span class="string">&quot;N95&quot;</span>));</span><br></pre></td></tr></table></figure>

<p>如果对于<code>Predicate</code>接口还不熟悉，没关系，以后的文章会介绍到，这里暂且知道它的抽象方法的签名是<code>(T) -&gt; boolean</code>就可以了。</p>
<h5 id="4-构造方法"><a href="#4-构造方法" class="headerlink" title="4. 构造方法"></a>4. 构造方法</h5><p>指向构造方法的引用，语法：<code>类名::new</code>，类名放在分隔符<code>::</code>前，<code>new</code>放在分隔符<code>::</code>后。比如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(String brand, String type) -&gt; <span class="keyword">new</span> Mask(brand, type)</span><br></pre></td></tr></table></figure>

<p>使用方法引用以后，可以简写为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Mask::<span class="keyword">new</span></span><br></pre></td></tr></table></figure>

<h4 id="小测试-1"><a href="#小测试-1" class="headerlink" title="小测试"></a>小测试</h4><p>看了这么多，是不是摩拳擦掌准备试一试了？我们就来几个小测试：</p>
<ol>
<li><code>(char[] array) -&gt; new String(array)</code></li>
<li><code>(String str) -&gt; str.length()</code></li>
<li><code>(String type) -&gt; mask.setType(type)</code>，其中的<code>mask</code>是一个<code>Mask</code>对象的局部变量。</li>
<li><code>(String str) -&gt; System.out.println(str)</code></li>
</ol>
<p>请思考片刻…<br>.<br>.<br>.<br><img src="/2021/04/23/1.8%E6%96%B0%E7%89%B9%E6%80%A7/lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/2.jpg" alt="img"><br>.<br>.<br>.</p>
<p><strong>宣布答案</strong>：</p>
<ol>
<li>因为<code>(char[] array) -&gt; new String(array)</code>是一个构造方法的Lambda表达式，此种方法引用的语法是：<code>类名::new</code>，所以正确答案是：<code>String::new</code>。</li>
<li>因为<code>(String str) -&gt; str.length()</code>是一个内部对象的实例方法的Lambda表达式，此种方法引用的语法是：<code>类名::实例方法名</code>，所以正确答案是：<code>String::length</code>。</li>
<li>因为<code>(String type) -&gt; mask.setType(type)</code>中的<code>mask</code>是一个<code>Mask</code>对象的局部变量，它是一个包含外部对象的Lambda表达式，此种方法引用的语法是：<code>实例名::实例方法名</code>，所以正确答案是<code>mask::setType</code>。</li>
<li>因为<code>(String str) -&gt; System.out.println(str)</code>是一个静态方法的Lambda表达式，此种方法引用的语法是：<code>类名::静态方法名</code>，所以正确答案是<code>System.out::println</code>。</li>
</ol>
<p>怎么样？都答对了嘛？</p>
<h1 id="（四）：常用的函数式接口"><a href="#（四）：常用的函数式接口" class="headerlink" title="（四）：常用的函数式接口"></a>（四）：常用的函数式接口</h1><p>在Java8支持Lambda表达式以后，为了满足Lambda表达式的一些典型使用场景，JDK为我们提供了大量常用的函数式接口。它们主要在 java.util.function 包中，下面简单介绍几个其中的接口及其使用示例。</p>
<h3 id="Supplier接口"><a href="#Supplier接口" class="headerlink" title="Supplier接口"></a>Supplier接口</h3><p><code>Supplier</code>接口是对象实例的提供者，定义了一个名叫<code>get</code>的抽象方法，它没有任何入参，并返回一个泛型T对象，具体源码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> java.util.function;</span><br><span class="line"></span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Supplier</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function">T <span class="title">get</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>源码比较简单，我们来个例子。这是之前提过的表示<strong>口罩</strong>的类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> one.more.study;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 口罩</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Mask</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Mask</span><span class="params">(String brand, String type)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.brand = brand;</span><br><span class="line">        <span class="keyword">this</span>.type = type;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 品牌</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String brand;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 类型</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String type;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getBrand</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> brand;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBrand</span><span class="params">(String brand)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.brand = brand;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> type;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setType</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.type = type;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>下面我们使用Lambda表达式声明一个<code>Supplier</code>的实例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Supplier&lt;Mask&gt; supplier = () -&gt; <span class="keyword">new</span> Mask(<span class="string">&quot;3M&quot;</span>, <span class="string">&quot;N95&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>用它来创建品牌为3M、类型为N95的<code>Mask</code>实例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Mask mask = supplier.get();</span><br><span class="line">System.out.println(<span class="string">&quot;Brand: &quot;</span> + mask.getBrand() + <span class="string">&quot;, Type: &quot;</span> + mask.getType());</span><br></pre></td></tr></table></figure>

<p>运行结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Brand: 3M, Type: N95</span><br></pre></td></tr></table></figure>

<p>特别需要注意的是，本例中每一次调用<code>get</code>方法都会创建新的对象。</p>
<h3 id="Consumer接口"><a href="#Consumer接口" class="headerlink" title="Consumer接口"></a>Consumer接口</h3><p><code>Consumer</code>接口是一个类似消费者的接口，定义了一个名叫<code>accept</code>的抽象方法，它的入参是一个泛型T对象，没有任何返回（void），主要源码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> java.util.function;</span><br><span class="line"></span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Consumer</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">accept</span><span class="params">(T t)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结合上面的<code>Supplier</code>接口，我们来个例子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Supplier&lt;Mask&gt; supplier = () -&gt; <span class="keyword">new</span> Mask(<span class="string">&quot;3M&quot;</span>, <span class="string">&quot;N95&quot;</span>);</span><br><span class="line">Consumer&lt;Mask&gt; consumer = (Mask mask) -&gt; &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;Brand: &quot;</span> + mask.getBrand() + <span class="string">&quot;, Type: &quot;</span> + mask.getType());</span><br><span class="line">&#125;;</span><br><span class="line">consumer.accept(supplier.get());</span><br></pre></td></tr></table></figure>

<p>首先使用Lambda表达式声明一个<code>Supplier</code>的实例，它是用来创建品牌为3M、类型为N95的<code>Mask</code>实例；再使用Lambda表达式声明一个<code>Consumer</code>的实例，它是用于打印出<code>Mask</code>实例的相关信息；最后<code>Consumer</code>消费了<code>Supplier</code>生产的<code>Mask</code>。运行结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Brand: 3M, Type: N95</span><br></pre></td></tr></table></figure>

<h3 id="Predicate接口"><a href="#Predicate接口" class="headerlink" title="Predicate接口"></a>Predicate接口</h3><p><code>Predicate</code>接口是判断是与否的接口，定义了一个名叫<code>test</code>的抽象方法，它的入参是一个泛型T对象，并返回一个boolean类型，主要源码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> java.util.function;</span><br><span class="line"></span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Predicate</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">test</span><span class="params">(T t)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结合上面的<code>Supplier</code>接口，我们来个例子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Supplier&lt;Mask&gt; supplier = () -&gt; <span class="keyword">new</span> Mask(<span class="string">&quot;3M&quot;</span>, <span class="string">&quot;N95&quot;</span>);</span><br><span class="line">Predicate&lt;Mask&gt; n95 = (Mask mask) -&gt; <span class="string">&quot;N95&quot;</span>.equals(mask.getType());</span><br><span class="line">Predicate&lt;Mask&gt; kn95 = (Mask mask) -&gt; <span class="string">&quot;KN95&quot;</span>.equals(mask.getType());</span><br><span class="line">System.out.println(<span class="string">&quot;是否为N95口罩：&quot;</span> + n95.test(supplier.get()));</span><br><span class="line">System.out.println(<span class="string">&quot;是否为KN95口罩：&quot;</span> + kn95.test(supplier.get()));</span><br></pre></td></tr></table></figure>

<p>首先使用Lambda表达式声明一个<code>Supplier</code>的实例，它是用来创建品牌为3M、类型为N95的<code>Mask</code>实例；再使用Lambda表达式声明一个<code>Predicate</code>的实例<strong>n95</strong>，它是用于判断是否为N95口罩；再使用Lambda表达式声明一个<code>Predicate</code>的实例<strong>kn95</strong>，它是用于判断是否为KN95口罩；最后分别用两个<code>Predicate</code>判断<code>Supplier</code>生产的<code>Mask</code>。运行结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">是否为N95口罩：true</span><br><span class="line">是否为KN95口罩：false</span><br></pre></td></tr></table></figure>

<h3 id="Function接口"><a href="#Function接口" class="headerlink" title="Function接口"></a>Function接口</h3><p><code>Function</code>接口是对实例进行处理转换的接口，定义了一个名叫<code>apply</code>的抽象方法，它的入参是一个泛型T对象，并返回一个泛型T对象，主要源码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> java.util.function;</span><br><span class="line"></span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Function</span>&lt;<span class="title">T</span>, <span class="title">R</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function">R <span class="title">apply</span><span class="params">(T t)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结合上面的<code>Supplier</code>接口，我们来个例子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Supplier&lt;Mask&gt; supplier = () -&gt; <span class="keyword">new</span> Mask(<span class="string">&quot;3M&quot;</span>, <span class="string">&quot;N95&quot;</span>);</span><br><span class="line">Function&lt;Mask, String&gt; brand = (Mask mask) -&gt; mask.getBrand();</span><br><span class="line">Function&lt;Mask, String&gt; type = (Mask mask) -&gt; mask.getType();</span><br><span class="line">System.out.println(<span class="string">&quot;口罩品牌：&quot;</span> + brand.apply(supplier.get()));</span><br><span class="line">System.out.println(<span class="string">&quot;口罩类型：&quot;</span> + type.apply(supplier.get()));</span><br></pre></td></tr></table></figure>

<p>首先使用Lambda表达式声明一个<code>Supplier</code>的实例，它是用来创建品牌为3M、类型为N95的<code>Mask</code>实例；再使用Lambda表达式声明一个<code>Function</code>的实例<strong>brand</strong>，它是用于获取口罩的品牌；再使用Lambda表达式声明一个<code>Function</code>的实例<strong>type</strong>，它是用于获取口罩的类型；最后分别用两个<code>Function</code>分析<code>Supplier</code>生产的<code>Mask</code>。运行结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">口罩品牌：3M</span><br><span class="line">口罩类型：N95</span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<h3 id="BiFunction接口"><a href="#BiFunction接口" class="headerlink" title="BiFunction接口"></a>BiFunction接口</h3><p><code>Function</code>接口的入参只有一个泛型对象，JDK还为我们提供了两个泛型对象入参的接口：<code>BiFunction</code>接口，主要源码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> java.util.function;</span><br><span class="line"></span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BiFunction</span>&lt;<span class="title">T</span>, <span class="title">U</span>, <span class="title">R</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function">R <span class="title">apply</span><span class="params">(T t, U u)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们可以用<code>BiFunction</code>接口传入两个<code>String</code>直接创建<code>Mask</code>实例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">BiFunction&lt;String,String,Mask&gt; biFunction = (String brand, String type) -&gt; <span class="keyword">new</span> Mask(brand, type);</span><br><span class="line">Mask mask = biFunction.apply(<span class="string">&quot;3M&quot;</span>, <span class="string">&quot;N95&quot;</span>);</span><br><span class="line">System.out.println(<span class="string">&quot;Brand: &quot;</span> + mask.getBrand() + <span class="string">&quot;, Type: &quot;</span> + mask.getType());</span><br></pre></td></tr></table></figure>

<p>运行结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Brand: 3M, Type: N95</span><br></pre></td></tr></table></figure>

<h3 id="基本数据类型"><a href="#基本数据类型" class="headerlink" title="基本数据类型"></a>基本数据类型</h3><p>以上介绍的几个常用的函数式接口入参和返回，都是泛型对象的，也就是必须为引用类型。当我们传入或获取的是基本数据类型时，将会发生自动装箱和自动拆箱，带来不必要的性能损耗，比如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Supplier&lt;Long&gt; supplier = () -&gt; System.currentTimeMillis();</span><br><span class="line"><span class="keyword">long</span> timeMillis = supplier.get();</span><br></pre></td></tr></table></figure>

<p>在上面例子里，发生了一次自动装箱（long被装箱为Long）和一次自动拆箱（Long被拆箱为long），如何避免这种不必要的性能损耗呢？JDK为我们提供相应的函数式接口，如<code>LongSupplier</code>接口，定义了一个名叫<code>getAsLong</code>的抽象方法，签名是<code>() -&gt; long</code>。上面的例子可以优化为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LongSupplier supplier = () -&gt; System.currentTimeMillis();</span><br><span class="line"><span class="keyword">long</span> timeMillis = supplier.getAsLong();</span><br></pre></td></tr></table></figure>

<p>类似这样的接口还有很多，我为大家整理了一下：</p>
<h4 id="Supplier相关的接口"><a href="#Supplier相关的接口" class="headerlink" title="Supplier相关的接口"></a>Supplier相关的接口</h4><table>
<thead>
<tr>
<th>接口名称</th>
<th>方法名称</th>
<th>方法签名</th>
</tr>
</thead>
<tbody><tr>
<td>Supplier</td>
<td>get</td>
<td>() -&gt; T</td>
</tr>
<tr>
<td>BooleanSupplier</td>
<td>getAsBoolean</td>
<td>() -&gt; boolean</td>
</tr>
<tr>
<td>DoubleSupplier</td>
<td>getAsDouble</td>
<td>() -&gt; double</td>
</tr>
<tr>
<td>IntSupplier</td>
<td>getAsInt</td>
<td>() -&gt; int</td>
</tr>
<tr>
<td>LongSupplier</td>
<td>getAsLong</td>
<td>() -&gt; long</td>
</tr>
</tbody></table>
<h4 id="Consumer相关的接口"><a href="#Consumer相关的接口" class="headerlink" title="Consumer相关的接口"></a>Consumer相关的接口</h4><table>
<thead>
<tr>
<th>接口名称</th>
<th>方法名称</th>
<th>方法签名</th>
</tr>
</thead>
<tbody><tr>
<td>Consumer</td>
<td>accept</td>
<td>(T) -&gt; void</td>
</tr>
<tr>
<td>DoubleConsumer</td>
<td>accept</td>
<td>(double) -&gt; void</td>
</tr>
<tr>
<td>IntConsumer</td>
<td>accept</td>
<td>(int) -&gt; void</td>
</tr>
<tr>
<td>LongConsumer</td>
<td>accept</td>
<td>(long) -&gt; void</td>
</tr>
<tr>
<td>ObjDoubleConsumer</td>
<td>accept</td>
<td>(T, double) -&gt; void</td>
</tr>
<tr>
<td>ObjIntConsumer</td>
<td>accept</td>
<td>(T, int) -&gt; void</td>
</tr>
<tr>
<td>ObjLongConsumer</td>
<td>accept</td>
<td>(T, long) -&gt; void</td>
</tr>
</tbody></table>
<h4 id="Predicate相关的接口"><a href="#Predicate相关的接口" class="headerlink" title="Predicate相关的接口"></a>Predicate相关的接口</h4><table>
<thead>
<tr>
<th>接口名称</th>
<th>方法名称</th>
<th>方法签名</th>
</tr>
</thead>
<tbody><tr>
<td>Predicate</td>
<td>test</td>
<td>(T) -&gt; boolean</td>
</tr>
<tr>
<td>BiPredicate</td>
<td>test</td>
<td>(T, U) -&gt; boolean</td>
</tr>
<tr>
<td>DoublePredicate</td>
<td>test</td>
<td>(double) -&gt; boolean</td>
</tr>
<tr>
<td>IntPredicate</td>
<td>test</td>
<td>(int) -&gt; boolean</td>
</tr>
<tr>
<td>LongPredicate</td>
<td>test</td>
<td>(long) -&gt; boolean</td>
</tr>
</tbody></table>
<h4 id="Function相关的接口"><a href="#Function相关的接口" class="headerlink" title="Function相关的接口"></a>Function相关的接口</h4><table>
<thead>
<tr>
<th>接口名称</th>
<th>方法名称</th>
<th>方法签名</th>
</tr>
</thead>
<tbody><tr>
<td>Function</td>
<td>apply</td>
<td>(T) -&gt; R</td>
</tr>
<tr>
<td>BiFunction</td>
<td>apply</td>
<td>(T, U) -&gt; R</td>
</tr>
<tr>
<td>DoubleFunction</td>
<td>apply</td>
<td>(double) -&gt; R</td>
</tr>
<tr>
<td>DoubleToIntFunction</td>
<td>applyAsInt</td>
<td>(double) -&gt; int</td>
</tr>
<tr>
<td>DoubleToLongFunction</td>
<td>applyAsLong</td>
<td>(double) -&gt; long</td>
</tr>
<tr>
<td>IntFunction</td>
<td>apply</td>
<td>(int) -&gt; R</td>
</tr>
<tr>
<td>IntToDoubleFunction</td>
<td>applyAsDouble</td>
<td>(int) -&gt; double</td>
</tr>
<tr>
<td>IntToLongFunction</td>
<td>applyAsLong</td>
<td>(int) -&gt; long</td>
</tr>
<tr>
<td>LongFunction</td>
<td>apply</td>
<td>(long) -&gt; R</td>
</tr>
<tr>
<td>LongToDoubleFunction</td>
<td>applyAsDouble</td>
<td>(long) -&gt; double</td>
</tr>
<tr>
<td>LongToIntFunction</td>
<td>applyAsInt</td>
<td>(long) -&gt; int</td>
</tr>
<tr>
<td>ToDoubleFunction</td>
<td>applyAsDouble</td>
<td>(T) -&gt; double</td>
</tr>
<tr>
<td>ToDoubleBiFunction</td>
<td>applyAsDouble</td>
<td>(T, U) -&gt; double</td>
</tr>
<tr>
<td>ToIntFunction</td>
<td>applyAsInt</td>
<td>(T) -&gt; int</td>
</tr>
<tr>
<td>ToIntBiFunction</td>
<td>applyAsInt</td>
<td>(T, U) -&gt; int</td>
</tr>
<tr>
<td>ToLongFunction</td>
<td>applyAsLong</td>
<td>(T) -&gt; long</td>
</tr>
<tr>
<td>ToLongBiFunction</td>
<td>applyAsLong</td>
<td>(T, U) -&gt; long</td>
</tr>
</tbody></table>
<h1 id="（五）：Comparator复合"><a href="#（五）：Comparator复合" class="headerlink" title="（五）：Comparator复合"></a>（五）：Comparator复合</h1><h3 id="Comparator的使用"><a href="#Comparator的使用" class="headerlink" title="Comparator的使用"></a>Comparator的使用</h3><p>在之前文章的例子中，我们使用<code>Comparator.comparing</code>静态方法构建了一个<code>Comparator</code>接口的实例，我们再来简单介绍一下。先来看看Mask类是怎么写的：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> one.more.study;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 口罩</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 万猫学社</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Mask</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Mask</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Mask</span><span class="params">(String brand, String type, <span class="keyword">double</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.brand = brand;</span><br><span class="line">        <span class="keyword">this</span>.type = type;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 品牌</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String brand;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 类型</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String type;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 价格</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> price;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getBrand</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> brand;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBrand</span><span class="params">(String brand)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.brand = brand;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> type;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setType</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.type = type;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">double</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Mask&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;brand=&#x27;&quot;</span> + brand + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, type=&#x27;&quot;</span> + type + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, price=&quot;</span> + price +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后，根据口罩品牌对口罩列表进行正序排序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Mask&gt; maskList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">maskList.add(<span class="keyword">new</span> Mask(<span class="string">&quot;3M&quot;</span>, <span class="string">&quot;KN95&quot;</span>,<span class="number">17.8</span>));</span><br><span class="line">maskList.add(<span class="keyword">new</span> Mask(<span class="string">&quot;Honeywell&quot;</span>, <span class="string">&quot;KN95&quot;</span>,<span class="number">18.8</span>));</span><br><span class="line">maskList.add(<span class="keyword">new</span> Mask(<span class="string">&quot;3M&quot;</span>, <span class="string">&quot;FFP2&quot;</span>,<span class="number">19.8</span>));</span><br><span class="line">maskList.add(<span class="keyword">new</span> Mask(<span class="string">&quot;Honeywell&quot;</span>, <span class="string">&quot;N95&quot;</span>,<span class="number">19.5</span>));</span><br><span class="line">maskList.sort(Comparator.comparing(Mask::getBrand));</span><br><span class="line"><span class="keyword">for</span> (Mask mask : maskList) &#123;</span><br><span class="line">    System.out.println(mask);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Mask&#123;brand&#x3D;&#39;3M&#39;, type&#x3D;&#39;KN95&#39;, price&#x3D;17.8&#125;</span><br><span class="line">Mask&#123;brand&#x3D;&#39;3M&#39;, type&#x3D;&#39;FFP2&#39;, price&#x3D;19.8&#125;</span><br><span class="line">Mask&#123;brand&#x3D;&#39;Honeywell&#39;, type&#x3D;&#39;KN95&#39;, price&#x3D;18.8&#125;</span><br><span class="line">Mask&#123;brand&#x3D;&#39;Honeywell&#39;, type&#x3D;&#39;N95&#39;, price&#x3D;19.5&#125;</span><br></pre></td></tr></table></figure>

<h3 id="逆序"><a href="#逆序" class="headerlink" title="逆序"></a>逆序</h3><p>需求改了，要求按照口罩品牌进行逆序排列，这是还需不需要再构建一个<code>Comparator</code>接口的实例呢？答案是不需要，<code>Comparator</code>接口有一个默认方法<code>reversed</code>可以使其逆序，把上面的例子稍微修改一下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">maskList.sort(Comparator.comparing(Mask::getBrand).reversed());</span><br></pre></td></tr></table></figure>

<p>运行结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Mask&#123;brand&#x3D;&#39;Honeywell&#39;, type&#x3D;&#39;KN95&#39;, price&#x3D;18.8&#125;</span><br><span class="line">Mask&#123;brand&#x3D;&#39;Honeywell&#39;, type&#x3D;&#39;N95&#39;, price&#x3D;19.5&#125;</span><br><span class="line">Mask&#123;brand&#x3D;&#39;3M&#39;, type&#x3D;&#39;KN95&#39;, price&#x3D;17.8&#125;</span><br><span class="line">Mask&#123;brand&#x3D;&#39;3M&#39;, type&#x3D;&#39;FFP2&#39;, price&#x3D;19.8&#125;</span><br></pre></td></tr></table></figure>

<h3 id="比较器链"><a href="#比较器链" class="headerlink" title="比较器链"></a>比较器链</h3><p>需求又改了，先按照口罩品牌逆序排序，如果口罩品牌一样，再按照口罩类型正序排序。<code>Comparator</code>接口还有一个默认方法<code>thenComparing</code>就是做这个的，它的入参也是一个<code>Function</code>接口的实例，如果前一个比较器的比较结果相同，就当前的比较器再进行比较，我们再来修改一下上面的例子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">maskList.sort(Comparator.comparing(Mask::getBrand)</span><br><span class="line">        .reversed()</span><br><span class="line">        .thenComparing(Mask::getType));</span><br></pre></td></tr></table></figure>

<p>运行结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Mask&#123;brand&#x3D;&#39;Honeywell&#39;, type&#x3D;&#39;KN95&#39;, price&#x3D;18.8&#125;</span><br><span class="line">Mask&#123;brand&#x3D;&#39;Honeywell&#39;, type&#x3D;&#39;N95&#39;, price&#x3D;19.5&#125;</span><br><span class="line">Mask&#123;brand&#x3D;&#39;3M&#39;, type&#x3D;&#39;FFP2&#39;, price&#x3D;19.8&#125;</span><br><span class="line">Mask&#123;brand&#x3D;&#39;3M&#39;, type&#x3D;&#39;KN95&#39;, price&#x3D;17.8&#125;</span><br></pre></td></tr></table></figure>

<p>需求又又改了，先按照口罩品牌逆序排序，如果口罩品牌一样，再按照口罩价格正序排序。口罩价格是<code>double</code>类型，如果使用<code>thenComparing</code>会导致自动装箱，造成资源的白白浪费。所以，推荐使用<code>thenComparingDouble</code>方法，它的入参是<code>ToDoubleFunction</code>，代码修改如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">maskList.sort(Comparator.comparing(Mask::getBrand)</span><br><span class="line">        .reversed()</span><br><span class="line">        .thenComparingDouble(Mask::getPrice));</span><br></pre></td></tr></table></figure>

<p>运行结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Mask&#123;brand&#x3D;&#39;Honeywell&#39;, type&#x3D;&#39;KN95&#39;, price&#x3D;18.8&#125;</span><br><span class="line">Mask&#123;brand&#x3D;&#39;Honeywell&#39;, type&#x3D;&#39;N95&#39;, price&#x3D;19.5&#125;</span><br><span class="line">Mask&#123;brand&#x3D;&#39;3M&#39;, type&#x3D;&#39;KN95&#39;, price&#x3D;17.8&#125;</span><br><span class="line">Mask&#123;brand&#x3D;&#39;3M&#39;, type&#x3D;&#39;FFP2&#39;, price&#x3D;19.8&#125;</span><br></pre></td></tr></table></figure>

<p>类似这样支持基础数据类型的方法还有两个，分别是：<code>thenComparingInt</code>方法，它的入参是<code>ToIntFunction</code>；<code>thenComparingLong</code>方法，它的入参是<code>ToLongFunction</code>。</p>
<h3 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h3><table>
<thead>
<tr>
<th>默认方法名称</th>
<th>作用</th>
<th>入参</th>
<th>入参签名</th>
</tr>
</thead>
<tbody><tr>
<td>reversed</td>
<td>逆序</td>
<td>无</td>
<td>无</td>
</tr>
<tr>
<td>thenComparing</td>
<td>比较器链</td>
<td>Function</td>
<td>(T) -&gt; R</td>
</tr>
<tr>
<td>thenComparingInt</td>
<td>比较器链</td>
<td>ToIntFunction</td>
<td>(T) -&gt; int</td>
</tr>
<tr>
<td>thenComparingLong</td>
<td>比较器链</td>
<td>ToLongFunction</td>
<td>(T) -&gt; long</td>
</tr>
<tr>
<td>thenComparingDouble</td>
<td>比较器链</td>
<td>ToDoubleFunction</td>
<td>(T) -&gt; double</td>
</tr>
</tbody></table>
<h3 id><a href="#" class="headerlink" title></a></h3><h1 id="（六）：Consumer、Predicate、Function复合"><a href="#（六）：Consumer、Predicate、Function复合" class="headerlink" title="（六）：Consumer、Predicate、Function复合"></a>（六）：Consumer、Predicate、Function复合</h1><h3 id="Consumer复合"><a href="#Consumer复合" class="headerlink" title="Consumer复合"></a>Consumer复合</h3><p><code>Consumer</code>接口中，有一个默认方法<code>andThen</code>，它的入参还是<code>Consumer</code>接口的实例。做完上一个<code>Consumer</code>的操作以后，再做当前<code>Consumer</code>的操作，就像工厂的流水线一样，比如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Consumer&lt;Mask&gt; brand = m -&gt; m.setBrand(<span class="string">&quot;3M&quot;</span>);</span><br><span class="line">Consumer&lt;Mask&gt; type = m -&gt; m.setType(<span class="string">&quot;N95&quot;</span>);</span><br><span class="line">Consumer&lt;Mask&gt; price = m -&gt; m.setPrice(<span class="number">19.9</span>);</span><br><span class="line">Consumer&lt;Mask&gt; print = System.out::println;</span><br><span class="line"></span><br><span class="line">brand.andThen(type)</span><br><span class="line">        .andThen(price)</span><br><span class="line">        .andThen(print)</span><br><span class="line">        .accept(<span class="keyword">new</span> Mask());</span><br></pre></td></tr></table></figure>

<p>上面的代码分别声明了4个<code>Consumer</code>接口的实例，然后再把它们组装成一个流水线，先把口罩品牌赋值为3M，再把口罩类型赋值为N95，再把口罩价格赋值为19.9，最后把口罩实例打印出来，运行结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Mask&#123;brand&#x3D;&#39;3M&#39;, type&#x3D;&#39;N95&#39;, price&#x3D;19.9&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Predicate复合"><a href="#Predicate复合" class="headerlink" title="Predicate复合"></a>Predicate复合</h3><p>Predicate接口一共有3个默认方法：<code>negate</code>、<code>and</code>和<code>or</code>，用它们可以创建更加复杂的Predicate接口实例。</p>
<h4 id="negate方法"><a href="#negate方法" class="headerlink" title="negate方法"></a>negate方法</h4><p>negate方法就是做非运算。比如，判断口罩类型是N95：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Mask mask = <span class="keyword">new</span> Mask(<span class="string">&quot;Honeywell&quot;</span>, <span class="string">&quot;N95&quot;</span>,<span class="number">19.5</span>);</span><br><span class="line">Predicate&lt;Mask&gt; isN95 = m -&gt; <span class="string">&quot;N95&quot;</span>.equals(m.getType());</span><br><span class="line">System.out.println(isN95.test(mask));</span><br></pre></td></tr></table></figure>

<p>运行结果为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">true</span><br></pre></td></tr></table></figure>

<p>那么，使用negate方法以后，就变成了判断口罩类型不是N95：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Mask mask = <span class="keyword">new</span> Mask(<span class="string">&quot;Honeywell&quot;</span>, <span class="string">&quot;N95&quot;</span>,<span class="number">19.5</span>);</span><br><span class="line">Predicate&lt;Mask&gt; isN95 = m -&gt; <span class="string">&quot;N95&quot;</span>.equals(m.getType());</span><br><span class="line">System.out.println(isN95.negate().test(mask));</span><br></pre></td></tr></table></figure>

<p>运行结果为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">false</span><br></pre></td></tr></table></figure>

<h4 id="and方法"><a href="#and方法" class="headerlink" title="and方法"></a>and方法</h4><p>and方法就是做与运算。比如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Mask mask = <span class="keyword">new</span> Mask(<span class="string">&quot;Honeywell&quot;</span>, <span class="string">&quot;N95&quot;</span>,<span class="number">19.5</span>);</span><br><span class="line">Predicate&lt;Mask&gt; isN95 = m -&gt; <span class="string">&quot;N95&quot;</span>.equals(m.getType());</span><br><span class="line">Predicate&lt;Mask&gt; lessThan20 = m -&gt; m.getPrice() &lt; <span class="number">20.0</span>;</span><br><span class="line">System.out.println(isN95.and(lessThan20).test(mask));</span><br></pre></td></tr></table></figure>

<p>上面的代码分别声明了2个<code>Predicate</code>接口的实例，分别是<strong>判断口罩类型是N95</strong>和<strong>判断口罩价格小于20</strong>，使用<code>and</code>方法以后，表示口罩类型是N95 <strong>并且</strong> 口罩价格小于20，运行结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">true</span><br></pre></td></tr></table></figure>

<h4 id="or方法"><a href="#or方法" class="headerlink" title="or方法"></a>or方法</h4><p>or方法就是做或运算。比如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Mask mask = <span class="keyword">new</span> Mask(<span class="string">&quot;Honeywell&quot;</span>, <span class="string">&quot;N95&quot;</span>, <span class="number">21.5</span>);</span><br><span class="line">Predicate&lt;Mask&gt; isN95 = m -&gt; <span class="string">&quot;N95&quot;</span>.equals(m.getType());</span><br><span class="line">Predicate&lt;Mask&gt; lessThan20 = m -&gt; m.getPrice() &lt; <span class="number">20.0</span>;</span><br><span class="line">System.out.println(isN95.or(lessThan20).test(mask));</span><br></pre></td></tr></table></figure>

<p>上面的代码分别声明了2个<code>Predicate</code>接口的实例，分别是<strong>判断口罩类型是N95</strong>和<strong>判断口罩价格小于20</strong>，使用<code>or</code>方法以后，表示口罩类型是N95 <strong>或者</strong> 口罩价格小于20，运行结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">true</span><br></pre></td></tr></table></figure>

<h4 id="and方法和or方法组合使用"><a href="#and方法和or方法组合使用" class="headerlink" title="and方法和or方法组合使用"></a>and方法和or方法组合使用</h4><p>当and方法和or方法组合使用时，优先级是由在Lambda表达式链中的位置决定的，从左到右优先级从高到低，比如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Mask mask = <span class="keyword">new</span> Mask(<span class="string">&quot;3M&quot;</span>, <span class="string">&quot;N95&quot;</span>, <span class="number">21.5</span>);</span><br><span class="line">Predicate&lt;Mask&gt; is3M = m -&gt; <span class="string">&quot;3M&quot;</span>.equals(m.getType());</span><br><span class="line">Predicate&lt;Mask&gt; isN95 = m -&gt; <span class="string">&quot;N95&quot;</span>.equals(m.getType());</span><br><span class="line">Predicate&lt;Mask&gt; lessThan20 = m -&gt; m.getPrice() &lt; <span class="number">20.0</span>;</span><br><span class="line">System.out.println(is3M.or(isN95).and(lessThan20).test(mask));</span><br></pre></td></tr></table></figure>

<p>上面的代码分别声明了3个<code>Predicate</code>接口的实例，分别是<strong>判断口罩品牌是3M</strong>、<strong>判断口罩类型是N95</strong>和<strong>判断口罩价格小于20</strong>，3个<code>Predicate</code>组合以后是<code>is3M.or(isN95).and(lessThan20)</code>，根据从左到右优先级从高到低，组合以后的逻辑是<code>(is3M || isN95 ) &amp;&amp; lessThan20</code>，所以运行结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">false</span><br></pre></td></tr></table></figure>

<h3 id="Function复合"><a href="#Function复合" class="headerlink" title="Function复合"></a>Function复合</h3><p>Function接口一共有2个默认方法，分别是：<code>andThen</code>和<code>compose</code>，用它们可以创建更加复杂的Function接口实例。</p>
<h4 id="andThen方法"><a href="#andThen方法" class="headerlink" title="andThen方法"></a>andThen方法</h4><p><code>Function</code>接口的<code>andThen</code>方法，和<code>Consumer</code>接口的类似，它的入参还是<code>Function</code>接口的实例。做完上一个<code>Function</code>的操作以后，再做当前<code>Function</code>的操作，比如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Function&lt;Integer, Integer&gt; plusTwo = x -&gt; x + <span class="number">2</span>;</span><br><span class="line">Function&lt;Integer, Integer&gt; timesThree = x -&gt; x * <span class="number">3</span>;</span><br><span class="line">System.out.println(plusTwo.andThen(timesThree).apply(<span class="number">1</span>));</span><br><span class="line">System.out.println(plusTwo.andThen(timesThree).apply(<span class="number">2</span>));</span><br><span class="line">System.out.println(plusTwo.andThen(timesThree).apply(<span class="number">3</span>));</span><br><span class="line"><span class="number">12345</span></span><br></pre></td></tr></table></figure>

<p>上面的代码分别声明了2个<code>Function</code>接口的实例，先加2，然后再乘以3，也就是<code>(x + 2) * 3</code>，运行结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">9</span><br><span class="line">12</span><br><span class="line">15</span><br></pre></td></tr></table></figure>

<h4 id="compose方法"><a href="#compose方法" class="headerlink" title="compose方法"></a>compose方法</h4><p><code>Function</code>接口的<code>compose</code>方法，和<code>andThen</code>方法相反的，先做当前<code>Function</code>的操作，然后再做上一个<code>Function</code>的操作，比如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Function&lt;Integer, Integer&gt; plusTwo = x -&gt; x + <span class="number">2</span>;</span><br><span class="line">Function&lt;Integer, Integer&gt; timesThree = x -&gt; x * <span class="number">3</span>;</span><br><span class="line">System.out.println(plusTwo.compose(timesThree).apply(<span class="number">1</span>));</span><br><span class="line">System.out.println(plusTwo.compose(timesThree).apply(<span class="number">2</span>));</span><br><span class="line">System.out.println(plusTwo.compose(timesThree).apply(<span class="number">3</span>));</span><br></pre></td></tr></table></figure>

<p>上面的代码分别声明了2个<code>Function</code>接口的实例，先乘以3，然后再加2，也就是<code>(x * 3) + 2</code>，运行结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">5</span><br><span class="line">8</span><br><span class="line">11</span><br></pre></td></tr></table></figure>





 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/1-8%E6%96%B0%E7%89%B9%E6%80%A7Lambda/" rel="tag">1.8新特性Lambda</a></li></ul>

    </footer>
  </div>

   
  <nav class="article-nav">
    
      <a href="/2021/04/23/gateway%E9%9B%86%E6%88%90knife4j/" class="article-nav-link">
        <strong class="article-nav-caption">上一篇</strong>
        <div class="article-nav-title">
          
            gateway集成knife4j
          
        </div>
      </a>
    
    
      <a href="/2021/04/21/nacos%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83%E4%B8%8E%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83/nacos%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83%E4%B8%8E%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83%E7%9A%84%E4%BD%BF%E7%94%A8/" class="article-nav-link">
        <strong class="article-nav-caption">下一篇</strong>
        <div class="article-nav-title">nacos配置中心与注册中心</div>
      </a>
    
  </nav>

   
<!-- valine评论 -->
<div id="vcomments-box">
  <div id="vcomments"></div>
</div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script>
<script>
  new Valine({
    el: "#vcomments",
    app_id: "",
    app_key: "",
    path: window.location.pathname,
    avatar: "monsterid",
    placeholder: "给我的文章加点评论吧~",
    recordIP: true,
  });
  const infoEle = document.querySelector("#vcomments .info");
  if (infoEle && infoEle.childNodes && infoEle.childNodes.length > 0) {
    infoEle.childNodes.forEach(function (item) {
      item.parentNode.removeChild(item);
    });
  }
</script>
<style>
  #vcomments-box {
    padding: 5px 30px;
  }

  @media screen and (max-width: 800px) {
    #vcomments-box {
      padding: 5px 0px;
    }
  }

  #vcomments-box #vcomments {
    background-color: #fff;
  }

  .v .vlist .vcard .vh {
    padding-right: 20px;
  }

  .v .vlist .vcard {
    padding-left: 10px;
  }
</style>

 
     
</article>

</section>
      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2018-2021
        <i class="ri-heart-fill heart_icon"></i> WangYinggang
      </li>
    </ul>
    
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>Visitors:<span id="busuanzi_value_site_uv"></span></s>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>Views:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
      </li>
    </ul>
  </div>
</footer>
      <div class="float_btns">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

      </div>
    </main>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt="WinGone&#39;s Blog"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">关于</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <script>
      if (window.matchMedia("(max-width: 768px)").matches) {
        document.querySelector('.content').classList.remove('on');
        document.querySelector('.sidebar').classList.remove('on');
      }
    </script>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="/images/1.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/2.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->


<script src="/js/tocbot.min.js"></script>

<script>
  tocbot.init({
    tocSelector: '.tocbot',
    contentSelector: '.article-entry',
    headingSelector: 'h1, h2, h3, h4, h5, h6',
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: 'main',
    positionFixedSelector: '.tocbot',
    positionFixedClass: 'is-position-fixed',
    fixedSidebarOffset: 'auto'
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script>

<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->


<script src="/js/busuanzi-2.3.pure.min.js"></script>


<!-- ClickLove -->

<!-- ClickBoom1 -->

<script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script>

<script src="/js/clickBoom1.js"></script>


<!-- ClickBoom2 -->

<!-- CodeCopy -->


<link rel="stylesheet" href="/css/clipboard.css">

<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>


<!-- CanvasBackground -->


<script src="/js/dz.js"></script>



    
  </div>
</body>

</html>