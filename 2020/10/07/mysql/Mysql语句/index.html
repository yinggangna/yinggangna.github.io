<!DOCTYPE html>


<html lang="en">


<head>
  <meta charset="utf-8" />
    
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>
    mysql语句 |  WinGone&#39;s Blog
  </title>
  <meta name="generator" content="hexo-theme-ayer">
  
  <link rel="shortcut icon" href="/favicon.ico" />
  
  
<link rel="stylesheet" href="/dist/main.css">

  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/css/remixicon.min.css">

  
<link rel="stylesheet" href="/css/custom.css">

  
  
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

  
  

  

</head>

</html>

<body>
  <div id="app">
    
      
    <main class="content on">
      <section class="outer">
  <article
  id="mysql-mysql/Mysql语句"
  class="article article-type-mysql"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  mysql语句
</h1>
 

    </header>
     
    <div class="article-meta">
      <a href="/2020/10/07/mysql/Mysql%E8%AF%AD%E5%8F%A5/" class="article-date">
  <time datetime="2020-10-07T04:55:33.000Z" itemprop="datePublished">2020-10-07</time>
</a>   
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> Word count:</span>
            <span class="post-count">12.2k</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> Reading time≈</span>
            <span class="post-count">54 min</span>
        </span>
    </span>
</div>
 
    </div>
      
    <div class="tocbot"></div>




  
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="一、综合使用-查询-目录："><a href="#一、综合使用-查询-目录：" class="headerlink" title="一、综合使用 查询 目录："></a>一、综合使用 查询 目录：</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#----综合使用</span></span><br><span class="line">书写顺序</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> * </span><br><span class="line"><span class="keyword">from</span> <span class="string">&#x27;表名&#x27;</span> </span><br><span class="line"><span class="keyword">where</span> <span class="string">&#x27;限制条件&#x27;</span>  </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="string">&#x27;分组依据&#x27;</span> </span><br><span class="line"><span class="keyword">having</span> <span class="string">&#x27;过滤条件&#x27;</span> </span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span>  </span><br><span class="line"><span class="keyword">limit</span> <span class="string">&#x27;展示条数&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">执行顺序</span><br><span class="line"><span class="keyword">from</span>       <span class="comment">-- 查询</span></span><br><span class="line"><span class="keyword">where</span>      <span class="comment">-- 限制条件</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span>   <span class="comment">-- 分组</span></span><br><span class="line"><span class="keyword">having</span>     <span class="comment">-- 过滤条件</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span>   <span class="comment">-- 排序</span></span><br><span class="line"><span class="keyword">limit</span>      <span class="comment">-- 展示条数</span></span><br><span class="line"><span class="keyword">distinct</span>   <span class="comment">-- 去重</span></span><br><span class="line"><span class="keyword">select</span>     <span class="comment">-- 查询的结果</span></span><br><span class="line">正则：<span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> <span class="keyword">name</span> regexp <span class="string">&#x27;^j.*(n|y)$&#x27;</span>;</span><br><span class="line">集合查询：max 、min 、avg 、sum 、count 、group_concat 。</span><br><span class="line">内连接：inner join</span><br><span class="line">左连接：left join</span><br><span class="line">右连接：right join</span><br><span class="line">全连接： 左连接 union 右连接</span><br><span class="line"><span class="keyword">replace</span> 替换</span><br><span class="line">拼接：<span class="keyword">concat</span>、<span class="keyword">concat_ws</span>、<span class="keyword">group_concat</span></span><br></pre></td></tr></table></figure>

<h2 id="二、常规设置操作"><a href="#二、常规设置操作" class="headerlink" title="二、常规设置操作"></a>二、常规设置操作</h2><h3 id="1-服务器设置远程访问"><a href="#1-服务器设置远程访问" class="headerlink" title="1.服务器设置远程访问"></a>1.服务器设置远程访问</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grant all privileges on *.* to &#x27;root&#x27;@&#x27;%&#x27; identified by &#x27;123456&#x27; with grant option;</span><br></pre></td></tr></table></figure>

<h3 id="2-Linux中数据库的基本操作命令"><a href="#2-Linux中数据库的基本操作命令" class="headerlink" title="2.Linux中数据库的基本操作命令"></a>2.Linux中数据库的基本操作命令</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1.使用service </span><br><span class="line"></span><br><span class="line">  启动：service mysql start</span><br><span class="line"></span><br><span class="line">  停止：service mysql stop</span><br><span class="line"></span><br><span class="line">  重启：service mysql restart</span><br><span class="line"></span><br><span class="line">2.清屏：clear,reset</span><br></pre></td></tr></table></figure>

<h3 id="3-备份数据库"><a href="#3-备份数据库" class="headerlink" title="3.备份数据库"></a>3.备份数据库</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">mysqldump -uroot -p密码 数据库名 &gt; D:/备份文件名.sql</span></span><br></pre></td></tr></table></figure>

<h3 id="4-恢复备份的数据库"><a href="#4-恢复备份的数据库" class="headerlink" title="4.恢复备份的数据库"></a>4.恢复备份的数据库</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">首先在mysql里建好数据库名</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">mysql -uroot -p密码 数据库名 &lt; D:/备份文件名.sql</span></span><br></pre></td></tr></table></figure>

<h3 id="5-查询binlog日志是否开启"><a href="#5-查询binlog日志是否开启" class="headerlink" title="5.查询binlog日志是否开启"></a>5.查询binlog日志是否开启</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show variables like &#x27;log_%&#x27;; </span><br></pre></td></tr></table></figure>

<p>###6.mysql linux 部分的配置</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">1. 通过secureCRT工具连接Linux系统</span><br><span class="line"></span><br><span class="line">2. 上传 mysql 的安装包</span><br><span class="line"></span><br><span class="line">    alt + p -------&gt; put d:/setup/mysql-5.7.27-1.el7.x86_64.rpm-bundle.tar</span><br><span class="line"></span><br><span class="line">3. 解压 mysql 的安装包</span><br><span class="line"></span><br><span class="line">	mkdir mysql</span><br><span class="line">    </span><br><span class="line">	tar -xvf mysql-5.7.27-1.el7.x86_64.rpm-bundle.tar -C mysql/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">4. 安装客户端</span><br><span class="line">    </span><br><span class="line">	cd mysql/</span><br><span class="line">    </span><br><span class="line">	rpm -ivh mysql-community-client-5.7.27-1.el7.x86_64.rpm --force --nodeps</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">5. 安装服务端</span><br><span class="line">    </span><br><span class="line">	rpm -ivh mysql-community-server-5.7.27-1.el7.x86_64.rpm --force --nodeps</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">6. 修改mysql默认字符集</span><br><span class="line">    </span><br><span class="line">	vi /etc/my.cnf</span><br><span class="line">    </span><br><span class="line">	添加如下内容：</span><br><span class="line">    </span><br><span class="line">	[mysqld]</span><br><span class="line">	character-set-server=utf8</span><br><span class="line">	collation-server=utf8_general_ci</span><br><span class="line"> </span><br><span class="line">	-- 在文件最下方添加</span><br><span class="line">    </span><br><span class="line">	[client]</span><br><span class="line">	default-character-set=utf8</span><br><span class="line"></span><br><span class="line">7. 启动mysql服务</span><br><span class="line">    </span><br><span class="line">	service mysqld start</span><br><span class="line"></span><br><span class="line">8. 登录mysql</span><br><span class="line">    </span><br><span class="line">	mysql -u root -p  敲回车，输入密码</span><br><span class="line">    </span><br><span class="line">	初始密码查看：cat /var/log/mysqld.log</span><br><span class="line">    </span><br><span class="line">	在root@localhost:   后面的就是初始密码</span><br><span class="line"></span><br><span class="line">9. 修改mysql登录密码</span><br><span class="line">    </span><br><span class="line">	set global validate_password_policy=0;</span><br><span class="line">    </span><br><span class="line">	set global validate_password_length=1;</span><br><span class="line">    </span><br><span class="line">	set password=password(&#x27;密码&#x27;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">10. 授予远程连接权限</span><br><span class="line">    </span><br><span class="line">	//授权</span><br><span class="line">	grant all privileges on *.* to &#x27;root&#x27; @&#x27;%&#x27; identified by &#x27;密码&#x27;;</span><br><span class="line">    </span><br><span class="line">	//刷新</span><br><span class="line">	flush privileges;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">11. 关闭Linux系统防火墙</span><br><span class="line">	systemctl stop firewalld</span><br><span class="line"></span><br><span class="line">12. 重启mysql服务</span><br><span class="line">	service mysqld restart</span><br><span class="line"></span><br><span class="line">13. 使用SQLYog工具连接mysql</span><br></pre></td></tr></table></figure>



<h2 id="三、代码命令整理"><a href="#三、代码命令整理" class="headerlink" title="三、代码命令整理"></a>三、代码命令整理</h2><h3 id="1-操作数据库"><a href="#1-操作数据库" class="headerlink" title="1 操作数据库"></a>1 操作数据库</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">	查询所有数据库</span><br><span class="line">	标准语法：</span><br><span class="line">		show databases;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 查询所有数据库</span><br><span class="line">show databases;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	查询某个数据库的创建语句</span><br><span class="line">	标准语法：</span><br><span class="line">		show create database 数据库名称;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 查询mysql数据库的创建语句</span><br><span class="line">show create database mysql;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	创建数据库</span><br><span class="line">	标准语法：</span><br><span class="line">		create database 数据库名称;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 创建db1数据库</span><br><span class="line">create database db1;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	创建数据库，判断、如果不存在则创建</span><br><span class="line">	标准语法：</span><br><span class="line">		create database if not exists 数据库名称;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 创建数据库db2(判断，如果不存在则创建)</span><br><span class="line">create database if not exists db2;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	创建数据库、并指定字符集</span><br><span class="line">	标准语法：</span><br><span class="line">		create database 数据库名称 character set 字符集名称;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 创建数据库db3、并指定字符集utf8</span><br><span class="line">create database db3 character set utf8;</span><br><span class="line"></span><br><span class="line">-- 查看db3数据库的字符集</span><br><span class="line">show create database db3;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 练习：创建db4数据库、如果不存在则创建，指定字符集为gbk</span><br><span class="line">create database if not exists db4 character set gbk;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 查看db4数据库的字符集</span><br><span class="line">show create database db4;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	修改数据库的字符集</span><br><span class="line">	标准语法：</span><br><span class="line">		alter database 数据库名称 character set 字符集名称;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 修改数据库db4的字符集为utf8</span><br><span class="line">alter database db4 character set utf8;</span><br><span class="line"></span><br><span class="line">-- 查看db4数据库的字符集</span><br><span class="line">show create database db4;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	删除数据库</span><br><span class="line">	标准语法：</span><br><span class="line">		drop database 数据库名称;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 删除db1数据库</span><br><span class="line">drop database db1;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	删除数据库，判断、如果存在则删除</span><br><span class="line">	标准语法：</span><br><span class="line">		drop database if exists 数据库名称;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 删除数据库db2，如果存在</span><br><span class="line">drop database if exists db2;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	使用数据库</span><br><span class="line">	标准语法：</span><br><span class="line">		use 数据库名称;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 使用db4数据库</span><br><span class="line">use db4;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	查询当前使用的数据库</span><br><span class="line">	标准语法：</span><br><span class="line">		select database();</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 查询当前正在使用的数据库</span><br><span class="line">select database();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="2-操作数据表"><a href="#2-操作数据表" class="headerlink" title="2 操作数据表"></a>2 操作数据表</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line">-- 使用mysql数据库</span><br><span class="line">use mysql;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	查询所有数据表</span><br><span class="line">	标准语法：</span><br><span class="line">		show tables;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 查询库中所有的表</span><br><span class="line">show tables;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	查询表结构</span><br><span class="line">	标准语法：</span><br><span class="line">		desc 表名;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 查询user表结构</span><br><span class="line">desc user;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	查询数据表的字符集</span><br><span class="line">	标准语法：</span><br><span class="line">		show table status from 数据库名称 like &#39;表名&#39;;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 查看mysql数据库中user表字符集</span><br><span class="line">show table status from mysql like &#39;user&#39;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	创建数据表</span><br><span class="line">	标准语法：</span><br><span class="line">		create table 表名(</span><br><span class="line">			列名 数据类型 约束,</span><br><span class="line">			列名 数据类型 约束,</span><br><span class="line">			...</span><br><span class="line">			列名 数据类型 约束</span><br><span class="line">		);</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 创建一个product商品表(商品编号、商品名称、商品价格、商品库存、上架时间)</span><br><span class="line">create table product(</span><br><span class="line">	id int,</span><br><span class="line">	name varchar(20),</span><br><span class="line">	price double,</span><br><span class="line">	stock int,</span><br><span class="line">	insert_time date</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 查看product表详细结构</span><br><span class="line">desc product;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	修改表名</span><br><span class="line">	标准语法：</span><br><span class="line">		alter table 旧表名 rename to 新表名;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 修改product表名为product2</span><br><span class="line">alter table product rename to product2;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	修改表的字符集</span><br><span class="line">	标准语法：</span><br><span class="line">		alter table 表名 character set 字符集名称;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 查看db3数据库中product2数据表字符集</span><br><span class="line">show table status from db3 like &#39;product2&#39;;</span><br><span class="line"></span><br><span class="line">-- 修改product2数据表字符集为gbk</span><br><span class="line">alter table product2 character set gbk;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	给表添加列</span><br><span class="line">	标准语法：</span><br><span class="line">		alter table 表名 add 列名 数据类型;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 给product2表添加一列color</span><br><span class="line">alter table product2 add color varchar(10);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	修改表中列的数据类型</span><br><span class="line">	标准语法：</span><br><span class="line">		alter table 表名 modify 列名 数据类型;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 将color数据类型修改为int</span><br><span class="line">alter table product2 modify color int;</span><br><span class="line"></span><br><span class="line">-- 查看product2表详细信息</span><br><span class="line">desc product2;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	修改表中列的名称和数据类型</span><br><span class="line">	标准语法：</span><br><span class="line">		alter table 表名 change 旧列名 新列名 数据类型;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 将color修改为address</span><br><span class="line">alter table product2 change color address varchar(200);</span><br><span class="line"></span><br><span class="line">-- 查看product2表详细信息</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	删除表中的列</span><br><span class="line">	标准语法：</span><br><span class="line">		alter table 表名 drop 列名;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 删除address列</span><br><span class="line">alter table product2 drop address;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	删除表</span><br><span class="line">	标准语法：</span><br><span class="line">		drop table 表名;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 删除product2表</span><br><span class="line">drop table product2;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	删除表，判断、如果存在则删除</span><br><span class="line">	标准语法：</span><br><span class="line">		drop table if exists 表名;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 删除product2表，如果存在则删除</span><br><span class="line">drop table if exists product2;</span><br></pre></td></tr></table></figure>

<h3 id="3-新增表数据"><a href="#3-新增表数据" class="headerlink" title="3 新增表数据"></a>3 新增表数据</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">	给指定列添加数据</span><br><span class="line">	标准语法：</span><br><span class="line">		insert into 表名(列名1,列名2,...) values (值1,值2,...);</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 向product表添加一条数据</span><br><span class="line">insert into product (id,name,price,stock,insert_time) values (1,&#39;手机&#39;,1999.99,25,&#39;2020-02-02&#39;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 向product表添加指定列数据</span><br><span class="line">insert into product (id,name,price) values (2,&#39;电脑&#39;,3999.99);</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	给全部列添加数据</span><br><span class="line">	标准语法：</span><br><span class="line">		insert into 表名 values (值1,值2,值3,...);</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 默认给全部列添加数据</span><br><span class="line">insert into product values (3,&#39;冰箱&#39;,1500,35,&#39;2030-03-03&#39;);</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	批量添加所有列数据</span><br><span class="line">	标准语法：</span><br><span class="line">		insert into 表名 values (值1,值2,值3,...),(值1,值2,值3,...),(值1,值2,值3,...);</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 批量添加数据</span><br><span class="line">insert into product values (4,&#39;洗衣机&#39;,800,15,&#39;2030-05-05&#39;),(5,&#39;微波炉&#39;,300,45,&#39;2030-06-06&#39;);</span><br></pre></td></tr></table></figure>

<h3 id="4-修改和删除表数据"><a href="#4-修改和删除表数据" class="headerlink" title="4 修改和删除表数据"></a>4 修改和删除表数据</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">	修改表数据</span><br><span class="line">	标准语法：</span><br><span class="line">		update 表名 set 列名1 &#x3D; 值1,列名2 &#x3D; 值2,... [where 条件];</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 修改手机的价格为3500</span><br><span class="line">update product set price&#x3D;3500 where name&#x3D;&#39;手机&#39;;</span><br><span class="line"></span><br><span class="line">-- 修改电脑的价格为1800、库存为36</span><br><span class="line">update product set price&#x3D;1900,stock&#x3D;36 where name&#x3D;&#39;电脑&#39;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	删除表数据</span><br><span class="line">	标准语法：</span><br><span class="line">		delete from 表名 [where 条件];</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 删除product表中的微波炉信息</span><br><span class="line">delete from product where name&#x3D;&#39;微波炉&#39;;</span><br><span class="line"></span><br><span class="line">-- 删除product表中库存为10的商品信息</span><br><span class="line">delete from product where stock&gt;10;</span><br></pre></td></tr></table></figure>

<h3 id="5-查看表数据"><a href="#5-查看表数据" class="headerlink" title="5 查看表数据"></a>5 查看表数据</h3><h4 id="5-1-数据准备"><a href="#5-1-数据准备" class="headerlink" title="5.1 数据准备"></a>5.1 数据准备</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">-- 创建db1数据库</span><br><span class="line">create database db1;</span><br><span class="line"></span><br><span class="line">-- 使用db1数据库</span><br><span class="line">use db1;</span><br><span class="line"></span><br><span class="line">-- 创建数据表</span><br><span class="line">create table product(</span><br><span class="line">	id int,			-- 商品编号</span><br><span class="line">	name varchar(20),	-- 商品名称</span><br><span class="line">	price double,		-- 商品价格</span><br><span class="line">	brand varchar(10),	-- 商品品牌</span><br><span class="line">	stock int,		-- 商品库存</span><br><span class="line">	insert_time date        -- 添加时间</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 添加数据</span><br><span class="line">insert into product values </span><br><span class="line">(1,&#39;华为手机&#39;,3999,&#39;华为&#39;,23,&#39;2088-03-10&#39;),</span><br><span class="line">(2,&#39;小米手机&#39;,2999,&#39;小米&#39;,30,&#39;2088-05-15&#39;),</span><br><span class="line">(3,&#39;苹果手机&#39;,5999,&#39;苹果&#39;,18,&#39;2088-08-20&#39;),</span><br><span class="line">(4,&#39;华为电脑&#39;,6999,&#39;华为&#39;,14,&#39;2088-06-16&#39;),</span><br><span class="line">(5,&#39;小米电脑&#39;,4999,&#39;小米&#39;,26,&#39;2088-07-08&#39;),</span><br><span class="line">(6,&#39;苹果电脑&#39;,8999,&#39;苹果&#39;,15,&#39;2088-10-25&#39;),</span><br><span class="line">(7,&#39;联想电脑&#39;,7999,&#39;联想&#39;,null,&#39;2088-11-11&#39;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="5-2-查询全部"><a href="#5-2-查询全部" class="headerlink" title="5.2 查询全部"></a>5.2 查询全部</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	查询全部数据</span><br><span class="line">	标准语法：</span><br><span class="line">		select * from 表名;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 查询product表所有数据</span><br><span class="line">select * from product;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	查询指定列</span><br><span class="line">	标准语法：</span><br><span class="line">		select 列名1,列名2,... from 表名;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 查询名称、价格、品牌</span><br><span class="line">select name,price,brand from product;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	去除重复查询</span><br><span class="line">	标准语法：</span><br><span class="line">		select distinct 列名1,列名2,... from 表名;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 查询品牌</span><br><span class="line">select brand from product;</span><br><span class="line">-- 查询品牌，去除重复</span><br><span class="line">select distinct brand from product;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	计算列的值</span><br><span class="line">	标准语法：</span><br><span class="line">		select 列名1 运算符(+ - * &#x2F;) 列名2 from 表名;</span><br><span class="line">		</span><br><span class="line">	如果某一列为null，可以进行替换</span><br><span class="line">	ifnull(表达式1,表达式2)</span><br><span class="line">	表达式1：想替换的列</span><br><span class="line">	表达式2：想替换的值</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 查询商品名称和库存，库存数量在原有基础上加10</span><br><span class="line">select name,stock+10 from product;</span><br><span class="line"></span><br><span class="line">-- 查询商品名称和库存，库存数量在原有基础上加10。进行null值判断</span><br><span class="line">select name,ifnull(stock,0)+10 from product;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	起别名</span><br><span class="line">	标准语法：</span><br><span class="line">		select 列名1,列名2,... as 别名 from 表名;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 查询商品名称和库存，库存数量在原有基础上加10。进行null值判断。起别名为getsum</span><br><span class="line">select name,ifnull(stock,0)+10 as getsum from product;</span><br><span class="line">select name,ifnull(stock,0)+10 getsum from product;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="5-3-条件查询"><a href="#5-3-条件查询" class="headerlink" title="5.3 条件查询"></a>5.3 条件查询</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">	条件查询</span><br><span class="line">	标准语法：</span><br><span class="line">		select 列名列表 from 表名 where 条件;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 查询库存大于20的商品信息</span><br><span class="line">select * from product where stock &gt; 20;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 查询品牌为华为的商品信息</span><br><span class="line">select * from product where brand&#x3D;&#39;华为&#39;;</span><br><span class="line"></span><br><span class="line">-- 查询金额在4000 ~ 6000之间的商品信息</span><br><span class="line">select * from product where price &gt;&#x3D; 4000 and price &lt;&#x3D; 6000;</span><br><span class="line">select * from product where price between 4000 and 6000;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 查询库存为14、30、23的商品信息</span><br><span class="line">select * from product where stock&#x3D;14 or stock&#x3D;30 or stock&#x3D;23;</span><br><span class="line">select * from product where stock in(14,30,23);</span><br><span class="line"></span><br><span class="line">-- 查询库存为null的商品信息</span><br><span class="line">select * from product where stock is null;</span><br><span class="line"></span><br><span class="line">-- 查询库存不为null的商品信息</span><br><span class="line">select * from product where stock is not null;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 查询名称以小米为开头的商品信息</span><br><span class="line">select * from product where name like &#39;小米%&#39;;</span><br><span class="line"></span><br><span class="line">-- 查询名称第二个字是为的商品信息</span><br><span class="line">select * from product where name like &#39;_为%&#39;;</span><br><span class="line"></span><br><span class="line">-- 查询名称为四个字符的商品信息</span><br><span class="line">select * from product where name like &#39;____&#39;;</span><br><span class="line"></span><br><span class="line">-- 查询名称中包含电脑的商品信息</span><br><span class="line">select * from product where name like &#39;%电脑%&#39;;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="5-4-聚合函数"><a href="#5-4-聚合函数" class="headerlink" title="5.4 聚合函数"></a>5.4 聚合函数</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">	聚合函数</span><br><span class="line">	标准语法：</span><br><span class="line">		select 函数名(列名) from 表名 [where 条件];</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 计算product表中总记录条数</span><br><span class="line">select count(*) from product;</span><br><span class="line"></span><br><span class="line">-- 获取最高价格</span><br><span class="line">select max(price) from product;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 获取最低库存</span><br><span class="line">select min(stock) from product;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 获取总库存数量</span><br><span class="line">select sum(stock) from product;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 获取品牌为苹果的总库存数量</span><br><span class="line">select sum(stock) from product where brand&#x3D;&#39;苹果&#39;;</span><br><span class="line"></span><br><span class="line">-- 获取品牌为小米的平均商品价格</span><br><span class="line">select avg(price) from product where brand&#x3D;&#39;小米&#39;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="5-5-排序查询"><a href="#5-5-排序查询" class="headerlink" title="5.5 排序查询"></a>5.5 排序查询</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">	排序查询</span><br><span class="line">	标准语法：</span><br><span class="line">		select 列名 from 表名 [where 条件] order by 列名1 排序方式1,列名2 排序方式2;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 按照库存升序排序</span><br><span class="line">select * from product order by stock asc;</span><br><span class="line"></span><br><span class="line">-- 查询名称中包含手机的商品信息。按照金额降序排序</span><br><span class="line">select * from product where name like &#39;%手机%&#39; order by price desc;</span><br><span class="line"></span><br><span class="line">-- 按照金额升序排序，如果金额相同，按照库存降序排列</span><br><span class="line">select * from product order by price asc,stock desc;</span><br></pre></td></tr></table></figure>

<h4 id="5-6-分组全部"><a href="#5-6-分组全部" class="headerlink" title="5.6 分组全部"></a>5.6 分组全部</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">	分组查询</span><br><span class="line">	标准语法：</span><br><span class="line">		select 列名 from 表名 [where 条件] group by 分组列名 [having 分组后条件过滤] [order by 排序列名 排序方式];</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 按照品牌分组，获取每组商品的总金额</span><br><span class="line">select brand,sum(price) from product group by brand;</span><br><span class="line"></span><br><span class="line">-- 对金额大于4000元的商品，按照品牌分组,获取每组商品的总金额</span><br><span class="line">select brand,sum(price) from product where price &gt; 4000 group by brand;</span><br><span class="line"></span><br><span class="line">-- 对金额大于4000元的商品，按照品牌分组，获取每组商品的总金额，只显示总金额大于7000元的</span><br><span class="line">select brand,sum(price) getsum from product where price &gt; 4000 group by brand having getsum &gt; 7000;</span><br><span class="line"></span><br><span class="line">-- 对金额大于4000元的商品，按照品牌分组，获取每组商品的总金额，只显示总金额大于7000元的、并按照总金额的降序排列</span><br><span class="line">select brand,sum(price) getsum from product </span><br><span class="line">where price &gt; 4000 </span><br><span class="line">group by brand </span><br><span class="line">having getsum &gt; 7000 </span><br><span class="line">order by getsum desc;</span><br></pre></td></tr></table></figure>

<h4 id="5-7-分页查询"><a href="#5-7-分页查询" class="headerlink" title="5.7 分页查询"></a>5.7 分页查询</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">	分页查询</span><br><span class="line">	标准语法：</span><br><span class="line">		select 列名 from 表名 </span><br><span class="line">		[where 条件] </span><br><span class="line">		[group by 分组列名]</span><br><span class="line">		[having 分组后条件过滤] </span><br><span class="line">		[order by 排序列名 排序方式] </span><br><span class="line">		limit 当前页数,每页显示的条数;</span><br><span class="line">	</span><br><span class="line">	limit 当前页数,每页显示的条数;</span><br><span class="line">	公式：当前页数 &#x3D; (当前页数-1) * 每页显示的条数</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 每页显示3条数据</span><br><span class="line"></span><br><span class="line">-- 第1页  当前页数&#x3D;(1-1) * 3</span><br><span class="line">select * from product limit 0,3;</span><br><span class="line"></span><br><span class="line">-- 第2页  当前页数&#x3D;(2-1) * 3</span><br><span class="line">select * from product limit 3,3;</span><br><span class="line"></span><br><span class="line">-- 第3页  当前页数&#x3D;(3-1) * 3</span><br><span class="line">select * from product limit 6,3;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="6-约束"><a href="#6-约束" class="headerlink" title="6 约束"></a>6 约束</h3><h4 id="6-1-主键约束"><a href="#6-1-主键约束" class="headerlink" title="6.1 主键约束"></a>6.1 主键约束</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">-- 创建学生表(编号、姓名、年龄)  编号设为主键</span><br><span class="line">create table student(</span><br><span class="line">	id int primary key,</span><br><span class="line">	name varchar(30),</span><br><span class="line">	age int</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 查询学生表的详细信息</span><br><span class="line">desc student;</span><br><span class="line"></span><br><span class="line">-- 添加数据</span><br><span class="line">insert into student values (1,&#39;张三&#39;,23);</span><br><span class="line">insert into student values (2,&#39;李四&#39;,24);</span><br><span class="line"></span><br><span class="line">-- 删除主键</span><br><span class="line">alter table student drop primary key;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 建表后单独添加主键约束</span><br><span class="line">alter table student modify id int primary key;</span><br></pre></td></tr></table></figure>

<h4 id="6-2-主键自增约束"><a href="#6-2-主键自增约束" class="headerlink" title="6.2 主键自增约束"></a>6.2 主键自增约束</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">-- 创建学生表(编号、姓名、年龄)  编号设为主键自增</span><br><span class="line">create table student(</span><br><span class="line">	id int primary key auto_increment,</span><br><span class="line">	name varchar(30),</span><br><span class="line">	age int</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 查询学生表的详细信息</span><br><span class="line">desc student;</span><br><span class="line"></span><br><span class="line">-- 添加数据</span><br><span class="line">insert into student values (null,&#39;张三&#39;,23),(null,&#39;李四&#39;,24);</span><br><span class="line"></span><br><span class="line">-- 删除自增约束</span><br><span class="line">alter table student modify id int;</span><br><span class="line">insert into student values (null,&#39;张三&#39;,23);</span><br><span class="line"></span><br><span class="line">-- 建表后单独添加自增约束</span><br><span class="line">alter table student modify id int auto_increment;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 建表时自定义自增起始值</span><br><span class="line">create table employee(</span><br><span class="line">	id int primary key auto_increment,</span><br><span class="line">	name varchar(30),</span><br><span class="line">	age int</span><br><span class="line">)auto_increment&#x3D;100;</span><br></pre></td></tr></table></figure>

<h4 id="6-3-唯一约束"><a href="#6-3-唯一约束" class="headerlink" title="6.3 唯一约束"></a>6.3 唯一约束</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">-- 创建学生表(编号、姓名、年龄)  编号设为主键自增，年龄设为唯一</span><br><span class="line">create table student(</span><br><span class="line">	id int primary key auto_increment,</span><br><span class="line">	name varchar(30),</span><br><span class="line">	age int unique</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 查询学生表的详细信息</span><br><span class="line">desc student;</span><br><span class="line"></span><br><span class="line">-- 添加数据</span><br><span class="line">insert into student values (null,&#39;张三&#39;,23);</span><br><span class="line">insert into student values (null,&#39;李四&#39;,23);</span><br><span class="line"></span><br><span class="line">-- 删除唯一约束</span><br><span class="line">alter table student drop index age;</span><br><span class="line"></span><br><span class="line">-- 建表后单独添加唯一约束</span><br><span class="line">alter table student modify age int unique;</span><br></pre></td></tr></table></figure>

<h4 id="6-4-非空约束"><a href="#6-4-非空约束" class="headerlink" title="6.4 非空约束"></a>6.4 非空约束</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">-- 创建学生表(编号、姓名、年龄)  编号设为主键自增，姓名设为非空，年龄设为唯一</span><br><span class="line">create table student(</span><br><span class="line">	id int primary key auto_increment,</span><br><span class="line">	name varchar(30) not null,</span><br><span class="line">	age int unique</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 查询学生表的详细信息</span><br><span class="line">desc student;</span><br><span class="line"></span><br><span class="line">-- 添加数据</span><br><span class="line">insert into student values (null,&#39;张三&#39;,23);</span><br><span class="line"></span><br><span class="line">-- 删除非空约束</span><br><span class="line">alter table student modify name varchar(30);</span><br><span class="line">insert into student values (null,null,25);</span><br><span class="line"></span><br><span class="line">-- 建表后单独添加非空约束</span><br><span class="line">alter table student modify name varchar(30) not null;</span><br></pre></td></tr></table></figure>

<h4 id="6-5-外键约束"><a href="#6-5-外键约束" class="headerlink" title="6.5 外键约束"></a>6.5 外键约束</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">-- 创建db2数据库</span><br><span class="line">create database db2;</span><br><span class="line"></span><br><span class="line">-- 使用db2数据库</span><br><span class="line">use db2;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	外键约束</span><br><span class="line">	标准语法：</span><br><span class="line">		constraint 外键名 foreign key (本表外键列名) references 主表名(主表主键列名)</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 建表时添加外键约束</span><br><span class="line">-- 创建user用户表</span><br><span class="line">create table user(</span><br><span class="line">	id int primary key auto_increment,    -- id</span><br><span class="line">	name varchar(20) not null             -- 姓名</span><br><span class="line">);</span><br><span class="line">-- 添加用户数据</span><br><span class="line">insert into user values (null,&#39;张三&#39;),(null,&#39;李四&#39;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 创建orderlist订单表</span><br><span class="line">create table orderlist(</span><br><span class="line">	id int primary key auto_increment,    -- id</span><br><span class="line">	number varchar(20) not null,          -- 订单编号</span><br><span class="line">	uid int,			      -- 外键列</span><br><span class="line">	constraint ou_fk1 foreign key (uid) references user(id)</span><br><span class="line">);</span><br><span class="line">-- 添加订单数据</span><br><span class="line">insert into orderlist values (null,&#39;hm001&#39;,1),(null,&#39;hm002&#39;,1),</span><br><span class="line">(null,&#39;hm003&#39;,2),(null,&#39;hm004&#39;,2);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 添加一个订单，但是没有真实用户。添加失败</span><br><span class="line">insert into orderlist values (null,&#39;hm005&#39;,3);</span><br><span class="line"></span><br><span class="line">-- 删除李四用户。删除失败</span><br><span class="line">delete from user where name&#x3D;&#39;李四&#39;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	删除外键约束</span><br><span class="line">	标准语法：</span><br><span class="line">		alter table 表名 drop foreign key 外键名;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 删除外键约束</span><br><span class="line">alter table orderlist drop foreign key ou_fk1;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	建表后单独添加外键约束</span><br><span class="line">	标准语法：</span><br><span class="line">		alter table 表名 add constraint 外键名 foreign key (本表外键列名) references 主表名(主键列名);</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 添加外键约束</span><br><span class="line">alter table orderlist add constraint ou_fk1 foreign key (uid) references user(id);</span><br></pre></td></tr></table></figure>

<h4 id="6-6-外键级联操作"><a href="#6-6-外键级联操作" class="headerlink" title="6.6 外键级联操作"></a>6.6 外键级联操作</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	添加外键约束，同时添加级联更新  标准语法：</span><br><span class="line">	alter table 表名 add constraint 外键名 foreign key (本表外键列名) references 主表名(主键列名) </span><br><span class="line">	on update cascade;</span><br><span class="line">	</span><br><span class="line">	添加外键约束，同时添加级联删除  标准语法：</span><br><span class="line">	alter table 表名 add constraint 外键名 foreign key (本表外键列名) references 主表名(主键列名) </span><br><span class="line">	on delete cascade;</span><br><span class="line">	</span><br><span class="line">	添加外键约束，同时添加级联更新和级联删除  标准语法：</span><br><span class="line">	alter table 表名 add constraint 外键名 foreign key (本表外键列名) references 主表名(主键列名) </span><br><span class="line">	on update cascade on delete cascade;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 删除外键约束</span><br><span class="line">alter table orderlist drop foreign key ou_fk1;</span><br><span class="line"></span><br><span class="line">-- 添加外键约束，同时添加级联更新和级联删除</span><br><span class="line">alter table orderlist add constraint ou_fk1 foreign key (uid) references user(id)</span><br><span class="line">on update cascade on delete cascade;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 将李四这个用户的id修改为3,订单表中的uid也自动修改</span><br><span class="line">update user set id&#x3D;3 where id&#x3D;2;</span><br><span class="line"></span><br><span class="line">-- 将李四这个用户删除,订单表中的该用户所属的订单也自动删除</span><br><span class="line">delete from user where id&#x3D;3;</span><br></pre></td></tr></table></figure>

<h3 id="7-多表操作"><a href="#7-多表操作" class="headerlink" title="7  多表操作"></a>7  多表操作</h3><h4 id="7-1-一对一"><a href="#7-1-一对一" class="headerlink" title="7.1 一对一"></a>7.1 一对一</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">-- 创建db3数据库</span><br><span class="line">create database db3;</span><br><span class="line"></span><br><span class="line">-- 使用db3数据库</span><br><span class="line">use db3;</span><br><span class="line"></span><br><span class="line">-- 创建person表</span><br><span class="line">create table person(</span><br><span class="line">	id int primary key auto_increment,	-- 主键id</span><br><span class="line">	name varchar(20)                        -- 姓名</span><br><span class="line">);</span><br><span class="line">-- 添加数据</span><br><span class="line">insert into person values (null,&#39;张三&#39;),(null,&#39;李四&#39;);</span><br><span class="line"></span><br><span class="line">-- 创建card表</span><br><span class="line">create table card(</span><br><span class="line">	id int primary key auto_increment,	-- 主键id</span><br><span class="line">	number varchar(20) unique not null,	-- 身份证号</span><br><span class="line">	pid int unique,                         -- 外键列</span><br><span class="line">	constraint cp_fk1 foreign key (pid) references person(id)</span><br><span class="line">);</span><br><span class="line">-- 添加数据</span><br><span class="line">insert into card values (null,&#39;12345&#39;,1),(null,&#39;56789&#39;,2);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="7-2-一对多"><a href="#7-2-一对多" class="headerlink" title="7.2 一对多"></a>7.2 一对多</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">-- 创建user表</span><br><span class="line">create table user(</span><br><span class="line">	id int primary key auto_increment,	-- 主键id</span><br><span class="line">	name varchar(20)                        -- 姓名</span><br><span class="line">);</span><br><span class="line">-- 添加数据</span><br><span class="line">insert into user values (null,&#39;张三&#39;),(null,&#39;李四&#39;);</span><br><span class="line"></span><br><span class="line">-- 创建orderlist表</span><br><span class="line">create table orderlist(</span><br><span class="line">	id int primary key auto_increment,	-- 主键id</span><br><span class="line">	number varchar(20),                     -- 订单编号</span><br><span class="line">	uid int,				-- 外键列</span><br><span class="line">	constraint ou_fk1 foreign key (uid) references user(id)</span><br><span class="line">);</span><br><span class="line">-- 添加数据</span><br><span class="line">insert into orderlist values (null,&#39;hm001&#39;,1),(null,&#39;hm002&#39;,1),(null,&#39;hm003&#39;,2),(null,&#39;hm004&#39;,2);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	商品分类和商品</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 创建category表</span><br><span class="line">create table category(</span><br><span class="line">	id int primary key auto_increment,	-- 主键id</span><br><span class="line">	name varchar(10)                        -- 分类名称</span><br><span class="line">);</span><br><span class="line">-- 添加数据</span><br><span class="line">insert into category values (null,&#39;手机数码&#39;),(null,&#39;电脑办公&#39;);</span><br><span class="line"></span><br><span class="line">-- 创建product表</span><br><span class="line">create table product(</span><br><span class="line">	id int primary key auto_increment,	-- 主键id</span><br><span class="line">	name varchar(30),			-- 商品名称</span><br><span class="line">	cid int,				-- 外键列</span><br><span class="line">	constraint pc_fk1 foreign key (cid) references category(id)</span><br><span class="line">);</span><br><span class="line">-- 添加数据</span><br><span class="line">insert into product values (null,&#39;华为p30&#39;,1),(null,&#39;小米note3&#39;,1),</span><br><span class="line">(null,&#39;联想电脑&#39;,2),(null,&#39;苹果电脑&#39;,2);</span><br></pre></td></tr></table></figure>

<h4 id="7-3-多对多"><a href="#7-3-多对多" class="headerlink" title="7.3 多对多"></a>7.3 多对多</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">-- 创建student表</span><br><span class="line">CREATE TABLE student(</span><br><span class="line">	id INT PRIMARY KEY AUTO_INCREMENT,	-- 主键id</span><br><span class="line">	NAME VARCHAR(20)			-- 学生姓名</span><br><span class="line">);</span><br><span class="line">-- 添加数据</span><br><span class="line">INSERT INTO student VALUES (NULL,&#39;张三&#39;),(NULL,&#39;李四&#39;);</span><br><span class="line"></span><br><span class="line">-- 创建course表</span><br><span class="line">CREATE TABLE course(</span><br><span class="line">	id INT PRIMARY KEY AUTO_INCREMENT,	-- 主键id</span><br><span class="line">	NAME VARCHAR(10)			-- 课程名称</span><br><span class="line">);</span><br><span class="line">-- 添加数据</span><br><span class="line">INSERT INTO course VALUES (NULL,&#39;语文&#39;),(NULL,&#39;数学&#39;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 创建中间表</span><br><span class="line">CREATE TABLE stu_course(</span><br><span class="line">	id INT PRIMARY KEY AUTO_INCREMENT,	-- 主键id</span><br><span class="line">	sid INT,  -- 用于和student表中的id进行外键关联</span><br><span class="line">	cid INT,  -- 用于和course表中的id进行外键关联</span><br><span class="line">	CONSTRAINT sc_fk1 FOREIGN KEY (sid) REFERENCES student(id), -- 添加外键约束</span><br><span class="line">	CONSTRAINT sc_fk2 FOREIGN KEY (cid) REFERENCES course(id)   -- 添加外键约束</span><br><span class="line">);</span><br><span class="line">-- 添加数据</span><br><span class="line">INSERT INTO stu_course VALUES (NULL,1,1),(NULL,1,2),(NULL,2,1),(NULL,2,2);</span><br></pre></td></tr></table></figure>

<h4 id="7-4-数据准备"><a href="#7-4-数据准备" class="headerlink" title="7.4 数据准备"></a>7.4 数据准备</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">-- 创建student表</span><br><span class="line">create table student(</span><br><span class="line">	id int primary key auto_increment,	-- 主键id</span><br><span class="line">	name varchar(20)			-- 学生姓名</span><br><span class="line">);</span><br><span class="line">-- 添加数据</span><br><span class="line">insert into student values (null,&#39;张三&#39;),(null,&#39;李四&#39;);</span><br><span class="line"></span><br><span class="line">-- 创建course表</span><br><span class="line">create table course(</span><br><span class="line">	id int primary key auto_increment,	-- 主键id</span><br><span class="line">	name varchar(10)			-- 课程名称</span><br><span class="line">);</span><br><span class="line">-- 添加数据</span><br><span class="line">insert into course values (null,&#39;语文&#39;),(null,&#39;数学&#39;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 创建中间表</span><br><span class="line">create table stu_course(</span><br><span class="line">	id int primary key auto_increment,	-- 主键id</span><br><span class="line">	sid int,  -- 用于和student表中的id进行外键关联</span><br><span class="line">	cid int,  -- 用于和course表中的id进行外键关联</span><br><span class="line">	constraint sc_fk1 foreign key (sid) references student(id), -- 添加外键约束</span><br><span class="line">	constraint sc_fk2 foreign key (cid) references course(id)   -- 添加外键约束</span><br><span class="line">);</span><br><span class="line">-- 添加数据</span><br><span class="line">insert into stu_course values (null,1,1),(null,1,2),(null,2,1),(null,2,2);</span><br></pre></td></tr></table></figure>

<h4 id="7-5-内连接查询"><a href="#7-5-内连接查询" class="headerlink" title="7.5 内连接查询"></a>7.5 内连接查询</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">	显示内连接</span><br><span class="line">	标准语法：</span><br><span class="line">		select 列名 from 表名1 [inner] join 表名2 on 关联条件;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 查询用户信息和对应的订单信息</span><br><span class="line">select * </span><br><span class="line">from user </span><br><span class="line">inner join orderlist </span><br><span class="line">on orderlist.uid &#x3D; user.id;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 查询用户信息和对应的订单信息，起别名</span><br><span class="line">select * </span><br><span class="line">from user u </span><br><span class="line">inner join orderlist o </span><br><span class="line">on o.uid&#x3D;u.id;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 查询用户姓名，年龄。和订单编号</span><br><span class="line">select</span><br><span class="line">	u.name,		-- 用户姓名</span><br><span class="line">	u.age,		-- 用户年龄</span><br><span class="line">	o.number	-- 订单编号</span><br><span class="line">from</span><br><span class="line">	user u          -- 用户表</span><br><span class="line">inner join</span><br><span class="line">	orderlist o     -- 订单表</span><br><span class="line">on</span><br><span class="line">	o.uid&#x3D;u.id;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	隐式内连接</span><br><span class="line">	标准语法：</span><br><span class="line">		select 列名 from 表名1,表名2 where 关联条件;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 查询用户姓名，年龄。和订单编号</span><br><span class="line">select</span><br><span class="line">	u.name,		-- 用户姓名</span><br><span class="line">	u.age,		-- 用户年龄</span><br><span class="line">	o.number	-- 订单编号</span><br><span class="line">from</span><br><span class="line">	user u,		-- 用户表</span><br><span class="line">	orderlist o     -- 订单表</span><br><span class="line">where</span><br><span class="line">	o.uid&#x3D;u.id;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="7-6-外连接查询"><a href="#7-6-外连接查询" class="headerlink" title="7.6 外连接查询"></a>7.6 外连接查询</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">	左外连接</span><br><span class="line">	标准语法：</span><br><span class="line">		select 列名 from 表名1 left [outer] join 表名2 on 条件;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 查询所有用户信息，以及用户对应的订单信息</span><br><span class="line">select</span><br><span class="line">	u.*,</span><br><span class="line">	o.number</span><br><span class="line">from</span><br><span class="line">	user u</span><br><span class="line">left outer join</span><br><span class="line">	orderlist o</span><br><span class="line">on</span><br><span class="line">	o.uid&#x3D;u.id;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	右外连接</span><br><span class="line">	标准语法：</span><br><span class="line">		select 列名 from 表名1 right [outer] join 表名2 on 条件;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 查询所有订单信息，以及订单所属的用户信息</span><br><span class="line">select</span><br><span class="line">	o.*,</span><br><span class="line">	u.name</span><br><span class="line">from</span><br><span class="line">	user u</span><br><span class="line">right outer join</span><br><span class="line">	orderlist o</span><br><span class="line">on</span><br><span class="line">	o.uid&#x3D;u.id;</span><br></pre></td></tr></table></figure>

<h4 id="7-7-子查询"><a href="#7-7-子查询" class="headerlink" title="7.7 子查询"></a>7.7 子查询</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	结果是单行单列的</span><br><span class="line">	标准语法：</span><br><span class="line">		select 列名 from 表名 where 列名&#x3D;(select 列名 from 表名 [where 条件]);</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 查询年龄最高的用户姓名</span><br><span class="line">select max(age) from user;</span><br><span class="line"></span><br><span class="line">select name,age </span><br><span class="line">from user </span><br><span class="line">where age&#x3D;(select max(age) from user);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	结果是多行单列的</span><br><span class="line">	标准语法：</span><br><span class="line">		select 列名 from 表名 where 列名 [not] in (select 列名 from 表名 [where 条件]); </span><br><span class="line">*&#x2F;</span><br><span class="line">-- 查询张三和李四的订单信息</span><br><span class="line">select * </span><br><span class="line">from orderlist </span><br><span class="line">where uid in (1,2);</span><br><span class="line"></span><br><span class="line">select id </span><br><span class="line">from user </span><br><span class="line">where name in (&#39;张三&#39;,&#39;李四&#39;);</span><br><span class="line"></span><br><span class="line">select * </span><br><span class="line">from orderlist </span><br><span class="line">where uid in (select id from user where name in (&#39;张三&#39;,&#39;李四&#39;));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	结果是多行多列的</span><br><span class="line">	标准语法：</span><br><span class="line">		select 列名 from 表名 [别名],(select 列名 from 表名 [where 条件]) [别名] [where 条件];</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 查询订单表中id大于4的订单信息和所属用户信息</span><br><span class="line">select * from orderlist where id &gt; 4;</span><br><span class="line"></span><br><span class="line">select</span><br><span class="line">	u.name,</span><br><span class="line">	o.number</span><br><span class="line">from</span><br><span class="line">	user u,</span><br><span class="line">	(select * from orderlist where id &gt; 4) o</span><br><span class="line">where</span><br><span class="line">	o.uid&#x3D;u.id;</span><br></pre></td></tr></table></figure>

<h4 id="7-8-自关联查询"><a href="#7-8-自关联查询" class="headerlink" title="7.8 自关联查询"></a>7.8 自关联查询</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">-- 创建员工表</span><br><span class="line">create table employee(</span><br><span class="line">	id int primary key auto_increment,	-- 员工编号</span><br><span class="line">	name varchar(20),			-- 员工姓名</span><br><span class="line">	mgr int,				-- 上级编号</span><br><span class="line">	salary double				-- 员工工资</span><br><span class="line">);</span><br><span class="line">-- 添加数据</span><br><span class="line">insert into employee values (1001,&#39;孙悟空&#39;,1005,9000.00),</span><br><span class="line">(1002,&#39;猪八戒&#39;,1005,8000.00),</span><br><span class="line">(1003,&#39;沙和尚&#39;,1005,8500.00),</span><br><span class="line">(1004,&#39;小白龙&#39;,1005,7900.00),</span><br><span class="line">(1005,&#39;唐僧&#39;,null,15000.00),</span><br><span class="line">(1006,&#39;武松&#39;,1009,7600.00),</span><br><span class="line">(1007,&#39;李逵&#39;,1009,7400.00),</span><br><span class="line">(1008,&#39;林冲&#39;,1009,8100.00),</span><br><span class="line">(1009,&#39;宋江&#39;,null,16000.00);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 查询所有员工的姓名及其直接上级的姓名，没有上级的员工也需要查询</span><br><span class="line">&#x2F;*</span><br><span class="line">分析</span><br><span class="line">	员工信息 employee表</span><br><span class="line">	条件：employee.mgr &#x3D; employee.id</span><br><span class="line">	查询左表的全部数据，和左右两张表有交集部分数据，左外连接</span><br><span class="line">*&#x2F;</span><br><span class="line">select</span><br><span class="line">	e1.id,</span><br><span class="line">	e1.name,</span><br><span class="line">	e1.mgr,</span><br><span class="line">	e2.id,</span><br><span class="line">	e2.name</span><br><span class="line">from</span><br><span class="line">	employee e1</span><br><span class="line">left outer join</span><br><span class="line">	employee e2</span><br><span class="line">on</span><br><span class="line">	e1.mgr &#x3D; e2.id;</span><br></pre></td></tr></table></figure>

<h4 id="7-9-多表查询练习"><a href="#7-9-多表查询练习" class="headerlink" title="7.9 多表查询练习"></a>7.9 多表查询练习</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br></pre></td><td class="code"><pre><span class="line">-- 1.查询用户的编号、姓名、年龄。订单编号</span><br><span class="line">&#x2F;*</span><br><span class="line">分析</span><br><span class="line">	用户的编号、姓名、年龄  user表      订单编号 orderlist表</span><br><span class="line">	条件：user.id&#x3D;orderlist.uid</span><br><span class="line">*&#x2F;</span><br><span class="line">select</span><br><span class="line">	u.id,</span><br><span class="line">	u.name,</span><br><span class="line">	u.age,</span><br><span class="line">	o.number</span><br><span class="line">from</span><br><span class="line">	user u,</span><br><span class="line">	orderlist o</span><br><span class="line">where</span><br><span class="line">	u.id&#x3D;o.uid;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 2.查询所有的用户。用户的编号、姓名、年龄。订单编号</span><br><span class="line">&#x2F;*</span><br><span class="line">分析</span><br><span class="line">	用户的编号、姓名、年龄  user表    订单编号 orderlist表</span><br><span class="line">	条件：user.id&#x3D;orderlist.uid</span><br><span class="line">	查询所有的用户，左外连接</span><br><span class="line">*&#x2F;</span><br><span class="line">select</span><br><span class="line">	u.id,</span><br><span class="line">	u.name,</span><br><span class="line">	u.age,</span><br><span class="line">	o.number</span><br><span class="line">from</span><br><span class="line">	user u</span><br><span class="line">left outer join</span><br><span class="line">	orderlist o</span><br><span class="line">on</span><br><span class="line">	u.id&#x3D;o.uid;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 3.查询所有的订单。用户的编号、姓名、年龄。订单编号</span><br><span class="line">&#x2F;*</span><br><span class="line">分析</span><br><span class="line">	用户的编号、姓名、年龄 user表    订单编号 orderlist表</span><br><span class="line">	条件：user.id&#x3D;orderlist.uid</span><br><span class="line">	查询所有的订单，右外连接</span><br><span class="line">*&#x2F;</span><br><span class="line">select</span><br><span class="line">	u.id,</span><br><span class="line">	u.name,</span><br><span class="line">	u.age,</span><br><span class="line">	o.number</span><br><span class="line">from</span><br><span class="line">	user u</span><br><span class="line">right outer join</span><br><span class="line">	orderlist o</span><br><span class="line">on</span><br><span class="line">	u.id&#x3D;o.uid;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">-- 4.查询用户年龄大于23岁的信息。显示用户的编号、姓名、年龄。订单编号</span><br><span class="line">&#x2F;*</span><br><span class="line">分析</span><br><span class="line">	用户的编号、姓名、年龄 user表    订单编号 orderlist表</span><br><span class="line">	条件：user.id&#x3D;orderlist.uid and user.age &gt; 23</span><br><span class="line">*&#x2F;</span><br><span class="line">select</span><br><span class="line">	u.id,</span><br><span class="line">	u.name,</span><br><span class="line">	u.age,</span><br><span class="line">	o.number</span><br><span class="line">from</span><br><span class="line">	user u,</span><br><span class="line">	orderlist o</span><br><span class="line">where</span><br><span class="line">	u.id&#x3D;o.uid</span><br><span class="line">	and</span><br><span class="line">	u.age &gt; 23;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 5.查询张三和李四用户的信息。显示用户的编号、姓名、年龄。订单编号</span><br><span class="line">&#x2F;*</span><br><span class="line">分析</span><br><span class="line">	用户的编号、姓名、年龄 user表   订单编号 orderlist表</span><br><span class="line">	条件：user.id&#x3D;orderlist.uid and user.name in (&#39;张三&#39;,&#39;李四&#39;)</span><br><span class="line">*&#x2F;</span><br><span class="line">select</span><br><span class="line">	u.id,</span><br><span class="line">	u.name,</span><br><span class="line">	u.age,</span><br><span class="line">	o.number</span><br><span class="line">from	user u,	</span><br><span class="line">	orderlist o</span><br><span class="line">where</span><br><span class="line">	u.id&#x3D;o.uid</span><br><span class="line">	and</span><br><span class="line">	u.name in (&#39;张三&#39;,&#39;李四&#39;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 6.查询商品分类的编号、分类名称。分类下的商品名称</span><br><span class="line">&#x2F;*</span><br><span class="line">分析</span><br><span class="line">	商品分类的编号、分类名称 category表    商品名称 product表</span><br><span class="line">	条件：category.id&#x3D;product.cid</span><br><span class="line">*&#x2F;</span><br><span class="line">select</span><br><span class="line">	c.id,</span><br><span class="line">	c.name,</span><br><span class="line">	p.name</span><br><span class="line">from</span><br><span class="line">	category c,</span><br><span class="line">	product p</span><br><span class="line">where</span><br><span class="line">	c.id&#x3D;p.cid;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 7.查询所有的商品分类。商品分类的编号、分类名称。分类下的商品名称</span><br><span class="line">&#x2F;*</span><br><span class="line">分析</span><br><span class="line">	商品分类的编号、分类名称 category表    商品名称 product表</span><br><span class="line">	条件：category.id&#x3D;product.cid</span><br><span class="line">	查询所有的商品分类，左外连接</span><br><span class="line">*&#x2F;</span><br><span class="line">select</span><br><span class="line">	c.id,</span><br><span class="line">	c.name,</span><br><span class="line">	p.name</span><br><span class="line">from</span><br><span class="line">	category c</span><br><span class="line">left outer join</span><br><span class="line">	product p</span><br><span class="line">on</span><br><span class="line">	c.id&#x3D;p.cid;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 8.查询所有的商品信息。商品分类的编号、分类名称。分类下的商品名称</span><br><span class="line">&#x2F;*</span><br><span class="line">分析</span><br><span class="line">	商品分类的编号、分类名称  category表   商品名称 product表</span><br><span class="line">	条件：category.id&#x3D;product.cid</span><br><span class="line">	查询所有的商品信息，右外连接</span><br><span class="line">*&#x2F;</span><br><span class="line">select</span><br><span class="line">	c.id,</span><br><span class="line">	c.name,</span><br><span class="line">	p.name</span><br><span class="line">from</span><br><span class="line">	category c</span><br><span class="line">right outer join</span><br><span class="line">	product p</span><br><span class="line">on</span><br><span class="line">	c.id&#x3D;p.cid;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 9.查询所有的用户和该用户能查看的所有的商品。显示用户的编号、姓名、年龄。商品名称</span><br><span class="line">&#x2F;*</span><br><span class="line">分析</span><br><span class="line">	用户的编号、姓名、年龄 user表   商品名称 product表    中间表 us_pro</span><br><span class="line">	条件：us_pro.uid&#x3D;user.id and us_pro.pid&#x3D;product.id</span><br><span class="line">*&#x2F;</span><br><span class="line">select</span><br><span class="line">	u.id,</span><br><span class="line">	u.name,</span><br><span class="line">	u.age,</span><br><span class="line">	p.name</span><br><span class="line">from</span><br><span class="line">	user u,</span><br><span class="line">	product p,</span><br><span class="line">	us_pro up</span><br><span class="line">where</span><br><span class="line">	up.uid&#x3D;u.id</span><br><span class="line">	and</span><br><span class="line">	up.pid&#x3D;p.id;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 10.查询张三和李四这两个用户可以看到的商品。显示用户的编号、姓名、年龄。商品名称</span><br><span class="line">&#x2F;*</span><br><span class="line">分析</span><br><span class="line">	用户的编号、姓名、年龄 user表   商品名称 product表   中间表 us_pro</span><br><span class="line">	条件：us_pro.uid&#x3D;user.id and us_pro.pid&#x3D;product.id and user.name in (&#39;张三&#39;,&#39;李四&#39;) </span><br><span class="line">*&#x2F;</span><br><span class="line">select</span><br><span class="line">	u.id,</span><br><span class="line">	u.name,</span><br><span class="line">	u.age,</span><br><span class="line">	p.name</span><br><span class="line">from</span><br><span class="line">	user u,</span><br><span class="line">	product p,</span><br><span class="line">	us_pro up</span><br><span class="line">where</span><br><span class="line">	up.uid&#x3D;u.id</span><br><span class="line">	and</span><br><span class="line">	up.pid&#x3D;p.id</span><br><span class="line">	and</span><br><span class="line">	u.name in (&#39;张三&#39;,&#39;李四&#39;);</span><br></pre></td></tr></table></figure>

<h3 id="8-存储过程和函数"><a href="#8-存储过程和函数" class="headerlink" title="8 存储过程和函数"></a>8 存储过程和函数</h3><h4 id="8-1-数据准备"><a href="#8-1-数据准备" class="headerlink" title="8.1 数据准备"></a>8.1 数据准备</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">-- 创建db6数据库</span><br><span class="line">create database db6;</span><br><span class="line">-- 使用db6数据库</span><br><span class="line">use db6;</span><br><span class="line">-- 创建学生表</span><br><span class="line">create table student (</span><br><span class="line">id int primary key auto_increment,</span><br><span class="line">-- 学生id</span><br><span class="line">name varchar ( 20 ),</span><br><span class="line">-- 学生姓名</span><br><span class="line">age int,</span><br><span class="line">-- 学生年龄</span><br><span class="line">gender varchar ( 5 ),</span><br><span class="line">-- 学生性别</span><br><span class="line">score int -- 学生成绩</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line">-- 添加数据</span><br><span class="line">insert into student</span><br><span class="line">values</span><br><span class="line">	( null, &#39;张三&#39;, 23, &#39;男&#39;, 95 ),</span><br><span class="line">	( null, &#39;李四&#39;, 24, &#39;男&#39;, 98 ),</span><br><span class="line">	( null, &#39;王五&#39;, 25, &#39;女&#39;, 100 ),</span><br><span class="line">	( null, &#39;赵六&#39;, 26, &#39;女&#39;, 90 );</span><br><span class="line">-- 按照性别进行分组，查询每组学生的总成绩。按照总成绩的升序排序</span><br><span class="line">select</span><br><span class="line">	gender,</span><br><span class="line">	sum( score ) getsum </span><br><span class="line">from</span><br><span class="line">	student </span><br><span class="line">group by</span><br><span class="line">	gender </span><br><span class="line">order by</span><br><span class="line">getsum asc;</span><br></pre></td></tr></table></figure>

<h4 id="8-2-创建和调用存储过程"><a href="#8-2-创建和调用存储过程" class="headerlink" title="8.2 创建和调用存储过程"></a>8.2 创建和调用存储过程</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">创建存储过程</span><br><span class="line"></span><br><span class="line">-- 修改分隔符为$</span><br><span class="line">delimiter $</span><br><span class="line"></span><br><span class="line">-- 标准语法</span><br><span class="line">create procedure 存储过程名称(参数列表)</span><br><span class="line">begin</span><br><span class="line">		sql 语句列表;</span><br><span class="line">end$</span><br><span class="line"></span><br><span class="line">-- 修改分隔符为分号</span><br><span class="line">delimiter ;</span><br><span class="line">*&#x2F; -- 创建stu_group()存储过程，封装 分组查询总成绩，并按照总成绩升序排序的功能</span><br><span class="line"></span><br><span class="line">delimiter$</span><br><span class="line">create procedure stu_group () begin</span><br><span class="line">	select</span><br><span class="line">		gender,</span><br><span class="line">		sum( score ) getsum </span><br><span class="line">	from</span><br><span class="line">		student </span><br><span class="line">	group by</span><br><span class="line">		gender </span><br><span class="line">	order by</span><br><span class="line">		getsum asc;</span><br><span class="line">	</span><br><span class="line">end $delimiter;</span><br><span class="line">&#x2F;*</span><br><span class="line">	调用存储过程</span><br><span class="line">	call 存储过程名称(实际参数);</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 调用stu_group()存储过程</span><br><span class="line">call stu_group ();</span><br></pre></td></tr></table></figure>

<h4 id="8-3-查看和删除存储过程"><a href="#8-3-查看和删除存储过程" class="headerlink" title="8.3 查看和删除存储过程"></a>8.3 查看和删除存储过程</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">查询数据库中所有的存储过程</span><br><span class="line">select * from mysql.proc where db&#x3D;&#39;数据库名称&#39;;</span><br><span class="line">*&#x2F; -- 查看db6数据库中所有的存储过程</span><br><span class="line">select</span><br><span class="line">	* </span><br><span class="line">from</span><br><span class="line">	mysql.proc </span><br><span class="line">where</span><br><span class="line">	db &#x3D; &#39;db6&#39;;</span><br><span class="line">&#x2F;*</span><br><span class="line">删除存储过程</span><br><span class="line">drop procedure [if exists] 存储过程名称;</span><br><span class="line">*&#x2F;</span><br><span class="line">drop procedure</span><br><span class="line">if</span><br><span class="line">	exists stu_group;</span><br></pre></td></tr></table></figure>

<h4 id="8-4-变量"><a href="#8-4-变量" class="headerlink" title="8.4 变量"></a>8.4 变量</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">定义变量</span><br><span class="line">declare 变量名 数据类型 [default 默认值];</span><br><span class="line">*&#x2F; -- 定义一个int类型变量，并赋默认值为10</span><br><span class="line"></span><br><span class="line">delimiter $</span><br><span class="line">create procedure pro_test1 ( ) begin</span><br><span class="line">-- 定义变量</span><br><span class="line">declare</span><br><span class="line">		num int default 10;</span><br><span class="line">-- 使用变量</span><br><span class="line">	select</span><br><span class="line">		num;</span><br><span class="line">	</span><br><span class="line">	end $delimiter;</span><br><span class="line">-- 调用pro_test1存储过程</span><br><span class="line">call pro_test1 ( );</span><br><span class="line">&#x2F;*</span><br><span class="line">	变量赋值-方式一</span><br><span class="line">	set 变量名 &#x3D; 变量值;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 定义一个varchar类型变量并赋值</span><br><span class="line"></span><br><span class="line">delimiter $</span><br><span class="line">create procedure pro_test2 ( ) begin</span><br><span class="line">-- 定义变量</span><br><span class="line">	declare</span><br><span class="line">		name varchar ( 10 );</span><br><span class="line">-- 为变量赋值</span><br><span class="line">	</span><br><span class="line">	set name &#x3D; &#39;存储过程&#39;;</span><br><span class="line">-- 使用变量</span><br><span class="line">	select name;</span><br><span class="line">	</span><br><span class="line">end $delimiter;</span><br><span class="line">-- 调用pro_test2存储过程</span><br><span class="line">call pro_test2 ( );</span><br><span class="line">&#x2F;*</span><br><span class="line">	变量赋值-方式二</span><br><span class="line">	select 列名 into 变量名 from 表名 [where 条件];</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 定义两个int变量，用于存储男女同学的总分数</span><br><span class="line"></span><br><span class="line">delimiter $</span><br><span class="line">create procedure pro_test3 ( ) begin</span><br><span class="line">-- 定义两个变量</span><br><span class="line">	declare</span><br><span class="line">		men,women int;</span><br><span class="line">-- 查询男同学的总分数，为men赋值</span><br><span class="line">	select</span><br><span class="line">		sum( score ) into men </span><br><span class="line">	from</span><br><span class="line">		student </span><br><span class="line">	where</span><br><span class="line">		gender &#x3D; &#39;男&#39;;</span><br><span class="line">-- 查询女同学的总分数，为women赋值</span><br><span class="line">	select</span><br><span class="line">		sum( score ) into women </span><br><span class="line">	from</span><br><span class="line">		student </span><br><span class="line">	where</span><br><span class="line">		gender &#x3D; &#39;女&#39;;</span><br><span class="line">-- 使用变量</span><br><span class="line">	select</span><br><span class="line">		men,</span><br><span class="line">		women;</span><br><span class="line">	</span><br><span class="line">end $delimiter;</span><br><span class="line">-- 调用pro_test3存储过程</span><br><span class="line">call pro_test3 ( );</span><br></pre></td></tr></table></figure>

<h4 id="8-5-if语句"><a href="#8-5-if语句" class="headerlink" title="8.5 if语句"></a>8.5 if语句</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">if语句</span><br><span class="line">if 判断条件1 then 执行的sql语句1;</span><br><span class="line">[elseif 判断条件2 then 执行的sql语句2;]</span><br><span class="line">...</span><br><span class="line">[else 执行的sql语句n;]</span><br><span class="line">end if;</span><br><span class="line">*&#x2F; &#x2F;*</span><br><span class="line">定义一个int变量，用于存储班级总成绩</span><br><span class="line">定义一个varchar变量，用于存储分数描述</span><br><span class="line">根据总成绩判断：</span><br><span class="line">380分及以上   学习优秀</span><br><span class="line">320 ~ 380     学习不错</span><br><span class="line">320以下       学习一般</span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">delimiter $</span><br><span class="line">create procedure pro_test4 ( ) begin</span><br><span class="line">-- 定义变量</span><br><span class="line">declare</span><br><span class="line">		total int;</span><br><span class="line">	declare</span><br><span class="line">		info varchar ( 10 );</span><br><span class="line">-- 查询总成绩，为total赋值</span><br><span class="line">	select</span><br><span class="line">		sum( score ) into total </span><br><span class="line">	from</span><br><span class="line">		student;</span><br><span class="line">-- 对总成绩判断</span><br><span class="line">	if</span><br><span class="line">		total &gt; 380 then</span><br><span class="line">			</span><br><span class="line">			set info &#x3D; &#39;学习优秀&#39;;</span><br><span class="line">		</span><br><span class="line">		elseif total &gt;&#x3D; 320 </span><br><span class="line">		and total &lt;&#x3D; 380 then</span><br><span class="line">			</span><br><span class="line">			set info &#x3D; &#39;学习不错&#39;;</span><br><span class="line">		else </span><br><span class="line">			set info &#x3D; &#39;学习一般&#39;;</span><br><span class="line">		</span><br><span class="line">	end if;</span><br><span class="line">-- 查询总成绩和描述信息</span><br><span class="line">		select</span><br><span class="line">			total,</span><br><span class="line">			info;</span><br><span class="line">		</span><br><span class="line">		end $delimiter;</span><br><span class="line">-- 调用pro_test4存储过程</span><br><span class="line">call pro_test4 ( );</span><br></pre></td></tr></table></figure>

<h4 id="8-6-参数传递"><a href="#8-6-参数传递" class="headerlink" title="8.6 参数传递"></a>8.6 参数传递</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">参数传递</span><br><span class="line">create procedure 存储过程名称([in|out|inout] 参数名 数据类型)</span><br><span class="line">begin</span><br><span class="line">	sql 语句列表;</span><br><span class="line">end$</span><br><span class="line">*&#x2F; &#x2F;*</span><br><span class="line">输入总成绩变量，代表学生总成绩</span><br><span class="line">输出分数描述变量，代表学生总成绩的描述信息</span><br><span class="line">根据总成绩判断：</span><br><span class="line">380分及以上  学习优秀</span><br><span class="line">320 ~ 380    学习不错</span><br><span class="line">320以下      学习一般</span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">delimiter $</span><br><span class="line">create procedure pro_test5 ( in total int, out info varchar ( 10 ) ) begin</span><br><span class="line">-- 对总成绩判断</span><br><span class="line">if</span><br><span class="line">		total &gt; 380 then</span><br><span class="line">			</span><br><span class="line">			set info &#x3D; &#39;学习优秀&#39;;</span><br><span class="line">		</span><br><span class="line">		elseif total &gt;&#x3D; 320 </span><br><span class="line">		and total &lt;&#x3D; 380 then</span><br><span class="line">			</span><br><span class="line">			set info &#x3D; &#39;学习不错&#39;;</span><br><span class="line">		else </span><br><span class="line">			set info &#x3D; &#39;学习一般&#39;;</span><br><span class="line">		</span><br><span class="line">	end if;</span><br><span class="line">	</span><br><span class="line">	end $delimiter;</span><br><span class="line">-- 调用pro_test5存储过程</span><br><span class="line">call pro_test5 ( 350, @info );</span><br><span class="line">call pro_test5 ( ( select sum( score ) from student ), @info );</span><br><span class="line">select</span><br><span class="line">@info;</span><br></pre></td></tr></table></figure>

<h4 id="8-7-white循环"><a href="#8-7-white循环" class="headerlink" title="8.7 white循环"></a>8.7 white循环</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">while循环</span><br><span class="line">初始化语句;</span><br><span class="line">while 条件判断语句 do</span><br><span class="line">循环体语句;</span><br><span class="line">条件控制语句;</span><br><span class="line">end while;</span><br><span class="line">*&#x2F; -- 计算1~100之间的偶数和</span><br><span class="line"></span><br><span class="line">delimiter $</span><br><span class="line">create procedure pro_test6 ( ) begin</span><br><span class="line">-- 定义求和变量</span><br><span class="line">declare</span><br><span class="line">		result int default 0;</span><br><span class="line">-- 定义初始化变量</span><br><span class="line">	declare</span><br><span class="line">		num int default 1;</span><br><span class="line">-- while循环</span><br><span class="line">	while</span><br><span class="line">			num &lt;&#x3D; 100 do</span><br><span class="line">		if</span><br><span class="line">			num % 2 &#x3D; 0 then</span><br><span class="line">				</span><br><span class="line">				set result &#x3D; result + num;</span><br><span class="line">			</span><br><span class="line">		end if;</span><br><span class="line">		</span><br><span class="line">		set num &#x3D; num + 1;</span><br><span class="line">		</span><br><span class="line">	end while;</span><br><span class="line">-- 查询求和结果</span><br><span class="line">	select</span><br><span class="line">		result;</span><br><span class="line">	</span><br><span class="line">	end $delimiter;</span><br><span class="line">-- 调用pro_test6存储过程</span><br><span class="line">call pro_test6 ( );</span><br></pre></td></tr></table></figure>

<h4 id="8-8-存储函数"><a href="#8-8-存储函数" class="headerlink" title="8.8 存储函数"></a>8.8 存储函数</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">while循环</span><br><span class="line">初始化语句;</span><br><span class="line">while 条件判断语句 do</span><br><span class="line">循环体语句;</span><br><span class="line">条件控制语句;</span><br><span class="line">end while;</span><br><span class="line">*&#x2F; -- 计算1~100之间的偶数和</span><br><span class="line"></span><br><span class="line">delimiter $</span><br><span class="line">create procedure pro_test6 ( ) begin</span><br><span class="line">-- 定义求和变量</span><br><span class="line">declare</span><br><span class="line">		result int default 0;</span><br><span class="line">-- 定义初始化变量</span><br><span class="line">	declare</span><br><span class="line">		num int default 1;</span><br><span class="line">-- while循环</span><br><span class="line">	while</span><br><span class="line">			num &lt;&#x3D; 100 do</span><br><span class="line">		if</span><br><span class="line">			num % 2 &#x3D; 0 then</span><br><span class="line">				</span><br><span class="line">				set result &#x3D; result + num;</span><br><span class="line">			</span><br><span class="line">		end if;</span><br><span class="line">		</span><br><span class="line">		set num &#x3D; num + 1;</span><br><span class="line">		</span><br><span class="line">	end while;</span><br><span class="line">-- 查询求和结果</span><br><span class="line">	select</span><br><span class="line">		result;</span><br><span class="line">&#x2F;*</span><br><span class="line">	创建存储函数</span><br><span class="line">	create function 函数名称([参数 数据类型])</span><br><span class="line">	returns 返回值类型</span><br><span class="line">	begin</span><br><span class="line">		执行的sql语句;</span><br><span class="line">		return 结果;</span><br><span class="line">	end$</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 定义存储函数，获取学生表中成绩大于95分的学生数量</span><br><span class="line">	</span><br><span class="line">	delimiter $</span><br><span class="line">	create function fun_test1 ( ) returns int begin</span><br><span class="line">-- 定义变量</span><br><span class="line">		declare</span><br><span class="line">			s_count int;</span><br><span class="line">-- 查询成绩大于95分的数量，为s_count赋值</span><br><span class="line">		select</span><br><span class="line">			count( * ) into s_count </span><br><span class="line">		from</span><br><span class="line">			student </span><br><span class="line">		where</span><br><span class="line">			score &gt; 95;</span><br><span class="line">-- 返回统计结果</span><br><span class="line">		return s_count;</span><br><span class="line">		</span><br><span class="line">	end $delimiter;</span><br><span class="line">&#x2F;*</span><br><span class="line">	调用函数</span><br><span class="line">	select 函数名称(实际参数);</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 调用函数</span><br><span class="line">select</span><br><span class="line">	fun_test1 ( );</span><br><span class="line">&#x2F;*</span><br><span class="line">	删除函数</span><br><span class="line">	drop function 函数名称;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 删除函数</span><br><span class="line">drop function fun_test1;</span><br><span class="line"></span><br><span class="line">end $delimiter;</span><br><span class="line">-- 调用pro_test6存储过程</span><br><span class="line">call pro_test6 ( );</span><br></pre></td></tr></table></figure>

<h3 id="9-触发器"><a href="#9-触发器" class="headerlink" title="9 触发器"></a>9 触发器</h3><h4 id="9-1-触发器的数据准备"><a href="#9-1-触发器的数据准备" class="headerlink" title="9.1 触发器的数据准备"></a>9.1 触发器的数据准备</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">-- 创建db7数据库</span><br><span class="line">create database db7;</span><br><span class="line">-- 使用db7数据库</span><br><span class="line">use db7;</span><br><span class="line">-- 创建账户表account</span><br><span class="line">create table account ( id int primary key auto_increment, -- 账户id</span><br><span class="line">name varchar ( 20 ), -- 姓名</span><br><span class="line">money double -- 余额</span><br><span class="line">);</span><br><span class="line">-- 添加数据</span><br><span class="line">insert into account</span><br><span class="line">values</span><br><span class="line">	( null, &#39;张三&#39;, 1000 ),</span><br><span class="line">	( null, &#39;李四&#39;, 1000 );</span><br><span class="line">-- 创建日志表account_log</span><br><span class="line">create table account_log (</span><br><span class="line">id int primary key auto_increment,</span><br><span class="line">-- 日志id</span><br><span class="line">operation varchar ( 20 ),</span><br><span class="line">-- 操作类型 (insert update delete)</span><br><span class="line">operation_time datetime,</span><br><span class="line">-- 操作时间</span><br><span class="line">operation_id int,</span><br><span class="line">-- 操作表的id</span><br><span class="line">operation_params varchar ( 200 ) -- 操作参数</span><br><span class="line"></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h4 id="9-2-insert型触发器"><a href="#9-2-insert型触发器" class="headerlink" title="9.2 insert型触发器"></a>9.2 insert型触发器</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">创建触发器</span><br><span class="line">delimiter $</span><br><span class="line"></span><br><span class="line">create trigger 触发器名称</span><br><span class="line">before|after insert|update|delete</span><br><span class="line">on 表名</span><br><span class="line">for each row</span><br><span class="line">begin</span><br><span class="line">	触发器要执行的功能;</span><br><span class="line">end$</span><br><span class="line"></span><br><span class="line">delimiter ;</span><br><span class="line">*&#x2F; -- 创建insert型触发器。用于对account表新增数据进行日志的记录</span><br><span class="line"></span><br><span class="line">delimiter $</span><br><span class="line">create trigger account_insert after insert on account for each row</span><br><span class="line">begin</span><br><span class="line">		insert into account_log</span><br><span class="line">	values</span><br><span class="line">		(</span><br><span class="line">			null,</span><br><span class="line">			&#39;insert&#39;,</span><br><span class="line">			now( ),</span><br><span class="line">			new.id,</span><br><span class="line">			concat( &#39;插入后&#123;id&#x3D;&#39;, new.id, &#39;,name&#x3D;&#39;, new.name, &#39;,money&#x3D;&#39;, new.money, &#39;&#125;&#39; ) </span><br><span class="line">		);</span><br><span class="line">	</span><br><span class="line">end $delimiter;</span><br><span class="line">-- 向account表添加一条记录</span><br><span class="line">insert into account</span><br><span class="line">values</span><br><span class="line">	( null, &#39;王五&#39;, 2000 );</span><br><span class="line">-- 查询account表</span><br><span class="line">select</span><br><span class="line">	* </span><br><span class="line">from</span><br><span class="line">	account;</span><br><span class="line">-- 查询account_log表</span><br><span class="line">select</span><br><span class="line">	* </span><br><span class="line">from</span><br><span class="line">account_log;</span><br></pre></td></tr></table></figure>

<h4 id="9-3-update型触发器"><a href="#9-3-update型触发器" class="headerlink" title="9.3 update型触发器"></a>9.3 update型触发器</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">创建触发器</span><br><span class="line">delimiter $</span><br><span class="line"></span><br><span class="line">create trigger 触发器名称</span><br><span class="line">before|after insert|update|delete</span><br><span class="line">on 表名</span><br><span class="line">for each row</span><br><span class="line">begin</span><br><span class="line">	触发器要执行的功能;</span><br><span class="line">end$</span><br><span class="line"></span><br><span class="line">delimiter ;</span><br><span class="line">*&#x2F; -- 创建update型触发器。用于对account表修改数据进行日志的记录</span><br><span class="line"></span><br><span class="line">delimiter $</span><br><span class="line">create trigger account_update after update on account for each row</span><br><span class="line">begin</span><br><span class="line">		insert into account_log</span><br><span class="line">	values</span><br><span class="line">		(</span><br><span class="line">			null,</span><br><span class="line">			&#39;update&#39;,</span><br><span class="line">			now( ),</span><br><span class="line">			new.id,</span><br><span class="line">			concat(</span><br><span class="line">				&#39;更新前&#123;id&#x3D;&#39;,</span><br><span class="line">				old.id,</span><br><span class="line">				&#39;,name&#x3D;&#39;,</span><br><span class="line">				old.name,</span><br><span class="line">				&#39;,money&#x3D;&#39;,</span><br><span class="line">				old.money,</span><br><span class="line">				&#39;&#125;&#39;,</span><br><span class="line">				&#39;更新后&#123;id&#x3D;&#39;,</span><br><span class="line">				new.id,</span><br><span class="line">				&#39;,name&#x3D;&#39;,</span><br><span class="line">				new.name,</span><br><span class="line">				&#39;,money&#x3D;&#39;,</span><br><span class="line">				new.money,</span><br><span class="line">				&#39;&#125;&#39; </span><br><span class="line">			) </span><br><span class="line">		);</span><br><span class="line">	</span><br><span class="line">end $delimiter;</span><br><span class="line">-- 修改account表中李四的金额为2000</span><br><span class="line">update account </span><br><span class="line">set money &#x3D; 2000 </span><br><span class="line">where</span><br><span class="line">	id &#x3D; 2;</span><br><span class="line">-- 查询account表</span><br><span class="line">select</span><br><span class="line">	* </span><br><span class="line">from</span><br><span class="line">	account;</span><br><span class="line">-- 查询account_log表</span><br><span class="line">select</span><br><span class="line">	* </span><br><span class="line">from</span><br><span class="line">account_log;</span><br></pre></td></tr></table></figure>

<h4 id="9-4-delete型触发器"><a href="#9-4-delete型触发器" class="headerlink" title="9.4 delete型触发器"></a>9.4 delete型触发器</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">创建触发器</span><br><span class="line">delimiter $</span><br><span class="line"></span><br><span class="line">create trigger 触发器名称</span><br><span class="line">before|after insert|update|delete</span><br><span class="line">on 表名</span><br><span class="line">for each row</span><br><span class="line">begin</span><br><span class="line">	触发器要执行的功能;</span><br><span class="line">end$</span><br><span class="line"></span><br><span class="line">delimiter ;</span><br><span class="line">*&#x2F; -- 创建delete型触发器。用于对account表删除数据进行日志的记录</span><br><span class="line"></span><br><span class="line">delimiter $</span><br><span class="line">create trigger account_delete after delete on account for each row</span><br><span class="line">begin</span><br><span class="line">		insert into account_log</span><br><span class="line">	values</span><br><span class="line">		(</span><br><span class="line">			null,</span><br><span class="line">			&#39;delete&#39;,</span><br><span class="line">			now( ),</span><br><span class="line">			old.id,</span><br><span class="line">			concat( &#39;删除前&#123;id&#x3D;&#39;, old.id, &#39;,name&#x3D;&#39;, old.name, &#39;,money&#x3D;&#39;, old.money, &#39;&#125;&#39; ) </span><br><span class="line">		);</span><br><span class="line">	</span><br><span class="line">end $delimiter;</span><br><span class="line">-- 删除account表中王五</span><br><span class="line">delete </span><br><span class="line">from</span><br><span class="line">	account </span><br><span class="line">where</span><br><span class="line">	id &#x3D; 3;</span><br><span class="line">-- 查询account表</span><br><span class="line">select</span><br><span class="line">	* </span><br><span class="line">from</span><br><span class="line">	account;</span><br><span class="line">-- 查询account_log表</span><br><span class="line">select</span><br><span class="line">	* </span><br><span class="line">from</span><br><span class="line">account_log;</span><br></pre></td></tr></table></figure>

<h4 id="9-5-查看和删除触发器"><a href="#9-5-查看和删除触发器" class="headerlink" title="9.5 查看和删除触发器"></a>9.5 查看和删除触发器</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">查看触发器</span><br><span class="line">show triggers;</span><br><span class="line">*&#x2F; -- 查看触发器</span><br><span class="line">show triggers;</span><br><span class="line">&#x2F;*</span><br><span class="line">删除触发器</span><br><span class="line">drop trigger 触发器名称;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 删除account_delete触发器</span><br><span class="line">drop trigger account_delete;</span><br></pre></td></tr></table></figure>

<h3 id="10-事物"><a href="#10-事物" class="headerlink" title="10 事物"></a>10 事物</h3><h4 id="事务的概念"><a href="#事务的概念" class="headerlink" title="事务的概念"></a>事务的概念</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">一条或多条 SQL 语句组成一个执行单元，其特点是这个单元要么同时成功要么同时失败。</span><br><span class="line">单元中的每条 SQL 语句都相互依赖，形成一个整体，如果某条 SQL 语句执行失败或者出现错误，那么整个单元就会回滚，撤回到事务最初的状态，如果单元中所有的 SQL 语句都执行成功，则事务就顺利执行。</span><br></pre></td></tr></table></figure>

<h4 id="事务的特征"><a href="#事务的特征" class="headerlink" title="事务的特征"></a>事务的特征</h4><ul>
<li>原子性(atomicity)<ul>
<li>原子性是指事务包含的所有操作要么全部成功，要么全部失败回滚，因此事务的操作如果成功就必须要完全应用到数据库，如果操作失败则不能对数据库有任何影响</li>
</ul>
</li>
<li>一致性(consistency)<ul>
<li>一致性是指事务必须使数据库从一个一致性状态变换到另一个一致性状态，也就是说一个事务执行之前和执行之后都必须处于一致性状态</li>
<li>拿转账来说，假设张三和李四两者的钱加起来一共是2000，那么不管A和B之间如何转账，转几次账，事务结束后两个用户的钱相加起来应该还得是2000，这就是事务的一致性</li>
</ul>
</li>
<li>隔离性(isolation)<ul>
<li>隔离性是当多个用户并发访问数据库时，比如操作同一张表时，数据库为每一个用户开启的事务，不能被其他事务的操作所干扰，多个并发事务之间要相互隔离</li>
</ul>
</li>
<li>持久性(durability)<ul>
<li>持久性是指一个事务一旦被提交了，那么对数据库中的数据的改变就是永久性的，即便是在数据库系统遇到故障的情况下也不会丢失提交事务的操作</li>
</ul>
</li>
</ul>
<h4 id="10-1-事务的数据准备"><a href="#10-1-事务的数据准备" class="headerlink" title="10.1 事务的数据准备"></a>10.1 事务的数据准备</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">-- 创建db8数据库</span><br><span class="line">create database db8;</span><br><span class="line"></span><br><span class="line">-- 使用db8数据库</span><br><span class="line">use db8;</span><br><span class="line"></span><br><span class="line">-- 创建账户表</span><br><span class="line">create table account(</span><br><span class="line">	id int primary key auto_increment,	-- 账户id</span><br><span class="line">	name varchar(20),			-- 账户名称</span><br><span class="line">	money double				-- 账户余额</span><br><span class="line">);</span><br><span class="line">-- 添加数据</span><br><span class="line">insert into account values (null,&#39;张三&#39;,1000),(null,&#39;李四&#39;,1000);</span><br></pre></td></tr></table></figure>

<h4 id="10-2-事务的基本使用"><a href="#10-2-事务的基本使用" class="headerlink" title="10.2 事务的基本使用"></a>10.2 事务的基本使用</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">-- 张三给李四转账500元</span><br><span class="line"></span><br><span class="line">-- 开启事务</span><br><span class="line">start transaction;</span><br><span class="line"></span><br><span class="line">-- 1.张三账户-500</span><br><span class="line">update account set money&#x3D;money-500 where name&#x3D;&#39;张三&#39;;</span><br><span class="line"></span><br><span class="line"> 出错了...</span><br><span class="line"></span><br><span class="line">-- 2.李四账户+500</span><br><span class="line">update account set money&#x3D;money+500 where name&#x3D;&#39;李四&#39;;</span><br><span class="line"></span><br><span class="line">-- 回滚事务</span><br><span class="line">rollback;</span><br><span class="line"></span><br><span class="line">-- 提交事务</span><br><span class="line">commit;</span><br></pre></td></tr></table></figure>

<h4 id="10-3-事务的提交方式"><a href="#10-3-事务的提交方式" class="headerlink" title="10.3 事务的提交方式"></a>10.3 事务的提交方式</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">	查询事务提交方式：select @@autocommit;  -- 1代表自动提交    0代表手动提交</span><br><span class="line">	默认是自动提交的</span><br><span class="line">	修改事务提交方式：set @@autocommit&#x3D;数字;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 查询事务的提交方式</span><br><span class="line">select @@autocommit;</span><br><span class="line"></span><br><span class="line">set @@autocommit &#x3D; 0;</span><br><span class="line">update account set money&#x3D;2000 where id&#x3D;1;</span><br><span class="line"></span><br><span class="line">commit;</span><br><span class="line">-- 保存到了内存当中</span><br><span class="line"></span><br><span class="line">-- 修改事务的提交方式</span><br><span class="line">set @@autocommit &#x3D; 1;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="10-4-隔离级别"><a href="#10-4-隔离级别" class="headerlink" title="10.4 隔离级别"></a>10.4 隔离级别</h4><h5 id="隔离级别的概念"><a href="#隔离级别的概念" class="headerlink" title="隔离级别的概念"></a>隔离级别的概念</h5><ul>
<li>多个客户端操作时 ,各个客户端的事务之间应该是隔离的，相互独立的 , 不受影响的。</li>
<li>而如果多个事务操作同一批数据时，则需要设置不同的隔离级别 , 否则就会产生问题 。</li>
<li>我们先来了解一下四种隔离级别的名称 , 再来看看可能出现的问题</li>
</ul>
<h5 id="四种隔离级别"><a href="#四种隔离级别" class="headerlink" title="四种隔离级别"></a>四种隔离级别</h5><table>
<thead>
<tr>
<th>1</th>
<th>读未提交</th>
<th>read uncommitted</th>
</tr>
</thead>
<tbody><tr>
<td><strong>2</strong></td>
<td><strong>读已提交</strong></td>
<td><strong>read committed</strong></td>
</tr>
<tr>
<td><strong>3</strong></td>
<td><strong>可重复读</strong></td>
<td><strong>repeatable read</strong></td>
</tr>
<tr>
<td><strong>4</strong></td>
<td><strong>串行化</strong></td>
<td><strong>serializable</strong></td>
</tr>
</tbody></table>
<p>可能引发的问题</p>
<table>
<thead>
<tr>
<th>问题</th>
<th>现象</th>
</tr>
</thead>
<tbody><tr>
<td><strong>脏读</strong></td>
<td><strong>是指在一个事务处理过程中读取了另一个未提交的事务中的数据 , 导致两次查询结果不一致</strong></td>
</tr>
<tr>
<td><strong>不可重复读</strong></td>
<td><strong>是指在一个事务处理过程中读取了另一个事务中修改并 询结果不一致</strong></td>
</tr>
<tr>
<td><strong>幻读</strong></td>
<td><strong>select 某记录是否存在，不存在，准备插入此记录，但执行 insert 时发现此记录已存在，无法插入。或不存在执行delete删除，却发现删除成功</strong></td>
</tr>
</tbody></table>
<h5 id="查询和修改事务的隔离级别"><a href="#查询和修改事务的隔离级别" class="headerlink" title="查询和修改事务的隔离级别"></a>查询和修改事务的隔离级别</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">	查询隔离级别：select @@tx_isolation;</span><br><span class="line">	修改隔离级别：set global transaction isolation level 级别字符串;</span><br><span class="line">*&#x2F;1</span><br><span class="line">-- 查询事务隔离级别</span><br><span class="line">select @@tx_isolation;</span><br><span class="line"></span><br><span class="line">-- 修改事务隔离级别(修改后需要重新连接)12请问</span><br><span class="line">set global transaction isolation level read committed;</span><br></pre></td></tr></table></figure>

<h4 id="10-5-脏读的问题演示和解决-窗口1"><a href="#10-5-脏读的问题演示和解决-窗口1" class="headerlink" title="10.5 脏读的问题演示和解决_窗口1"></a>10.5 脏读的问题演示和解决_窗口1</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">	脏读的问题演示和解决</span><br><span class="line">	脏读：一个事务中读取到了其他事务“未提交”的数据</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 设置事务隔离级别为read uncommitted</span><br><span class="line">set global transaction isolation level read uncommitted;</span><br><span class="line">-- 设置事务隔离级别为read committed</span><br><span class="line">set global transaction isolation level read committed;</span><br><span class="line"></span><br><span class="line">-- 开启事务</span><br><span class="line">start transaction;</span><br><span class="line"></span><br><span class="line">-- 转账</span><br><span class="line">update account set money &#x3D; money-500 where name&#x3D;&#39;张三&#39;;</span><br><span class="line">update account set money &#x3D; money+500 where name&#x3D;&#39;李四&#39;;</span><br><span class="line"></span><br><span class="line">-- 查询account表</span><br><span class="line">select * from account;</span><br><span class="line"></span><br><span class="line">-- 回滚</span><br><span class="line">rollback;</span><br><span class="line"></span><br><span class="line">-- 提交事务</span><br><span class="line">commit;</span><br></pre></td></tr></table></figure>

<h4 id="10-5-脏读的问题演示和解决-窗口2"><a href="#10-5-脏读的问题演示和解决-窗口2" class="headerlink" title="10.5 脏读的问题演示和解决_窗口2"></a>10.5 脏读的问题演示和解决_窗口2</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">-- 查询事务隔离级别</span><br><span class="line">select @@tx_isolation;</span><br><span class="line"></span><br><span class="line">-- 开启事务</span><br><span class="line">start transaction;</span><br><span class="line"></span><br><span class="line">-- 查询account表</span><br><span class="line">select * from account;</span><br><span class="line"></span><br><span class="line">-- 提交事务</span><br><span class="line">commit;</span><br></pre></td></tr></table></figure>

<h4 id="10-6-不可重复读的问题演示和解决-窗口1"><a href="#10-6-不可重复读的问题演示和解决-窗口1" class="headerlink" title="10.6 不可重复读的问题演示和解决_窗口1"></a>10.6 不可重复读的问题演示和解决_窗口1</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">	不可重复读的问题演示和解决</span><br><span class="line">	不可重复读：一个事务中读取到了其他事务“已提交”的数据</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 设置事务隔离级别为read committed</span><br><span class="line">set global transaction isolation level read committed;</span><br><span class="line">set global transaction isolation level repeatable read;</span><br><span class="line"></span><br><span class="line">-- 开启事务</span><br><span class="line">start transaction;</span><br><span class="line"></span><br><span class="line">-- 转账</span><br><span class="line">update account set money &#x3D; money-500 where name&#x3D;&#39;张三&#39;;</span><br><span class="line">update account set money &#x3D; money+500 where name&#x3D;&#39;李四&#39;;</span><br><span class="line"></span><br><span class="line">-- 查询account表</span><br><span class="line">select * from account;</span><br><span class="line"></span><br><span class="line">-- 提交事务</span><br><span class="line">commit;</span><br></pre></td></tr></table></figure>

<h4 id="10-6-不可重复读的问题演示和解决-窗口2"><a href="#10-6-不可重复读的问题演示和解决-窗口2" class="headerlink" title="10.6 不可重复读的问题演示和解决_窗口2"></a>10.6 不可重复读的问题演示和解决_窗口2</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">-- 查询隔离级别</span><br><span class="line">select @@tx_isolation;</span><br><span class="line">-- 设置事务隔离级别为read uncommitted</span><br><span class="line">-- 开启事务</span><br><span class="line">start transaction;</span><br><span class="line"></span><br><span class="line">-- 查询account表</span><br><span class="line">select * from account;</span><br><span class="line"></span><br><span class="line">-- 提交事务</span><br><span class="line">commit;</span><br></pre></td></tr></table></figure>

<h4 id="10-7-幻读的问题演示和解决-窗口1"><a href="#10-7-幻读的问题演示和解决-窗口1" class="headerlink" title="10.7 幻读的问题演示和解决_窗口1"></a>10.7 幻读的问题演示和解决_窗口1</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">	幻读的问题演示和解决</span><br><span class="line">	查询某记录是否存在，不存在</span><br><span class="line">	准备插入此记录，但执行插入时发现此记录已存在，无法插入</span><br><span class="line">	或某记录不存在执行删除，却发现删除成功</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 设置隔离级别为repeatable read</span><br><span class="line">set global transaction isolation level repeatable read;</span><br><span class="line">set global transaction isolation level serializable;</span><br><span class="line"></span><br><span class="line">-- 开启事务</span><br><span class="line">start transaction;</span><br><span class="line"></span><br><span class="line">-- 添加记录</span><br><span class="line">insert into account values (3,&#39;王五&#39;,2000);</span><br><span class="line">insert into account values (4,&#39;赵六&#39;,3000);</span><br><span class="line"></span><br><span class="line">-- 查询account表</span><br><span class="line">select * from account;</span><br><span class="line"></span><br><span class="line">-- 提交事务</span><br><span class="line">commit;</span><br></pre></td></tr></table></figure>

<h4 id="10-7-幻读的问题演示和解决-窗口2"><a href="#10-7-幻读的问题演示和解决-窗口2" class="headerlink" title="10.7 幻读的问题演示和解决_窗口2"></a>10.7 幻读的问题演示和解决_窗口2</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">-- 查询隔离级别</span><br><span class="line">select @@tx_isolation;</span><br><span class="line"></span><br><span class="line">-- 开启事务</span><br><span class="line">start transaction;</span><br><span class="line"></span><br><span class="line">-- 查询account表</span><br><span class="line">select * from account;</span><br><span class="line"></span><br><span class="line">-- 添加</span><br><span class="line">insert into account values (3,&#39;王五&#39;,2000);</span><br><span class="line"></span><br><span class="line">-- 提交事务</span><br><span class="line">commit;</span><br></pre></td></tr></table></figure>

<h3 id="11-存储引擎"><a href="#11-存储引擎" class="headerlink" title="11 存储引擎"></a>11 存储引擎</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">	查询数据库支持的存储引擎</span><br><span class="line">	show engines;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 查询数据库支持的存储引擎</span><br><span class="line">show engines;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	查询某个数据库中所有数据表的存储引擎</span><br><span class="line">	show table status from 数据库名称;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 查询db4数据库所有表的存储引擎</span><br><span class="line">show table status from db4;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	查询某个数据库中某个表的存储引擎</span><br><span class="line">	show table status from 数据库名称 where name &#x3D; &#39;数据表名称&#39;;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 查看db4数据库中category表的存储引擎</span><br><span class="line">show table status from db4 where name &#x3D; &#39;category&#39;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	创建数据表指定存储引擎</span><br><span class="line">	create table 表名(</span><br><span class="line">	      列名,数据类型,</span><br><span class="line">	      ...</span><br><span class="line">	)engine &#x3D; 引擎名称;</span><br><span class="line">*&#x2F;</span><br><span class="line">create table engine_test(</span><br><span class="line">	id int primary key auto_increment,</span><br><span class="line">	name varchar(10)</span><br><span class="line">)engine &#x3D; myisam;</span><br><span class="line"></span><br><span class="line">show table status from db4;</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	修改数据表的存储引擎</span><br><span class="line">	alter table 表名 engine &#x3D; 引擎名称;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 修改engine_test表的存储引擎为innodb</span><br><span class="line">alter table engine_test engine &#x3D; innodb;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="12-索引"><a href="#12-索引" class="headerlink" title="12 索引"></a>12 索引</h3><p>数据准备</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">-- 创建db9数据库</span><br><span class="line">create database db9;</span><br><span class="line"></span><br><span class="line">-- 使用db9数据库</span><br><span class="line">use db9;</span><br><span class="line"></span><br><span class="line">-- 创建student表</span><br><span class="line">create table student(</span><br><span class="line">	id int primary key auto_increment,</span><br><span class="line">	name varchar(10),</span><br><span class="line">	age int,</span><br><span class="line">	score int</span><br><span class="line">);</span><br><span class="line">-- 添加数据</span><br><span class="line">insert into student values (null,&#39;张三&#39;,23,98),(null,&#39;李四&#39;,24,95),</span><br><span class="line">(null,&#39;王五&#39;,25,96),(null,&#39;赵六&#39;,26,94),(null,&#39;周七&#39;,27,99);</span><br></pre></td></tr></table></figure>

<p>创建和查询索引</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">	创建索引</span><br><span class="line">	create [unique|fulltext] index 索引名称</span><br><span class="line">	[using 索引类型]  -- 默认是btree</span><br><span class="line">	on 表名(列名...);</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 为student表中的name列创建一个普通索引</span><br><span class="line">create index idx_name on student(name); </span><br><span class="line"></span><br><span class="line">-- 为student表中的age列创建一个唯一索引</span><br><span class="line">create unique index idx_age on student(age);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	查询索引</span><br><span class="line">	show index from 表名;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 查询student表中的索引  (主键列自带主键索引)</span><br><span class="line">show index from student;</span><br><span class="line"></span><br><span class="line">-- 查询db4数据库中的product表 (外键列自带外键索引)</span><br><span class="line">show index from product;</span><br></pre></td></tr></table></figure>

<p>添加和删除索引</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">	alter添加索引</span><br><span class="line">	-- 普通索引</span><br><span class="line">	alter table 表名 add index 索引名称(列名);</span><br><span class="line"></span><br><span class="line">	-- 组合索引</span><br><span class="line">	alter table 表名 add index 索引名称(列名1,列名2,...);</span><br><span class="line"></span><br><span class="line">	-- 主键索引</span><br><span class="line">	alter table 表名 add primary key(主键列名); </span><br><span class="line"></span><br><span class="line">	-- 外键索引(添加外键约束，就是外键索引)</span><br><span class="line">	alter table 表名 add constraint 外键名 foreign key (本表外键列名) references 主表名(主键列名);</span><br><span class="line"></span><br><span class="line">	-- 唯一索引</span><br><span class="line">	alter table 表名 add unique 索引名称(列名);</span><br><span class="line"></span><br><span class="line">	-- 全文索引</span><br><span class="line">	alter table 表名 add fulltext 索引名称(列名);</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 为student表中score列添加唯一索引</span><br><span class="line">alter table student add unique idx_score(score);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 查询student表的索引</span><br><span class="line">show index from student;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">	删除索引</span><br><span class="line">	drop index 索引名称 on 表名;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 删除idx_score索引</span><br><span class="line">drop index idx_score on student;</span><br></pre></td></tr></table></figure>



<h3 id="13-锁"><a href="#13-锁" class="headerlink" title="13 锁"></a>13 锁</h3><h5 id="13-1-InnoDB锁的数据准备"><a href="#13-1-InnoDB锁的数据准备" class="headerlink" title="13.1 InnoDB锁的数据准备"></a>13.1 InnoDB锁的数据准备</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">-- 创建db10数据库</span><br><span class="line">create database db10;</span><br><span class="line"></span><br><span class="line">-- 使用db10数据库</span><br><span class="line">use db10;</span><br><span class="line"></span><br><span class="line">-- 创建student表</span><br><span class="line">create table student(</span><br><span class="line">	id int primary key auto_increment,</span><br><span class="line">	name varchar(10),</span><br><span class="line">	age int,</span><br><span class="line">	score int</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 添加数据</span><br><span class="line">insert into student values (null,&#39;张三&#39;,23,99),(null,&#39;李四&#39;,24,95),</span><br><span class="line">(null,&#39;王五&#39;,25,98),(null,&#39;赵六&#39;,26,97);</span><br></pre></td></tr></table></figure>



<h5 id="13-2-InnoDB共享锁-窗口1"><a href="#13-2-InnoDB共享锁-窗口1" class="headerlink" title="13.2 InnoDB共享锁_窗口1"></a>13.2 InnoDB共享锁_窗口1</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">	共享锁：数据可以被多个事务查询，但是不能修改</span><br><span class="line">	创建锁的格式</span><br><span class="line">		select语句 lock in share mode;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 开启事务</span><br><span class="line">start transaction;</span><br><span class="line"></span><br><span class="line">-- 查询id为1数据，并加入共享锁</span><br><span class="line">select * from student where id&#x3D;1 lock in share mode;</span><br><span class="line"></span><br><span class="line">-- 查询分数为99的数据，并加入共享锁</span><br><span class="line">select * from student where score&#x3D;99 lock in share mode;</span><br><span class="line"></span><br><span class="line">-- 提交事务</span><br><span class="line">commit;</span><br></pre></td></tr></table></figure>



<h5 id="13-2-InnoDB共享锁-窗口2"><a href="#13-2-InnoDB共享锁-窗口2" class="headerlink" title="13.2 InnoDB共享锁_窗口2"></a>13.2 InnoDB共享锁_窗口2</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">-- 开启事务</span><br><span class="line">start transaction;</span><br><span class="line"></span><br><span class="line">-- 查询id为1数据,(普通查询没问题)</span><br><span class="line">select * from student where id&#x3D;1;</span><br><span class="line"></span><br><span class="line">-- 查询id为1数据,也加入共享锁(共享锁和共享锁是兼容)</span><br><span class="line">select * from student where id&#x3D;1 lock in share mode;</span><br><span class="line"></span><br><span class="line">-- 修改id为1数据，姓名改成张三三(修改失败。会出现锁的情况。只有窗口1提交事务后才能修改成功)</span><br><span class="line">update student set name&#x3D;&#39;张三三&#39; where id&#x3D;1;</span><br><span class="line"></span><br><span class="line">-- 修改id为2数据，姓名改成李四四(修改成功，innodb引擎默认加的是行锁)</span><br><span class="line">update student set name&#x3D;&#39;李四四&#39; where id&#x3D;2;</span><br><span class="line"></span><br><span class="line">-- 修改id为3数据，姓名改成王五五(修改失败，innodb引擎如果不采用带索引的列加锁，加的就是表锁)</span><br><span class="line">update student set name&#x3D;&#39;王五五&#39; where id&#x3D;3;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 提交事务</span><br><span class="line">commit;</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="13-3-InnoDB排他锁-窗口1"><a href="#13-3-InnoDB排他锁-窗口1" class="headerlink" title="13.3 InnoDB排他锁_窗口1"></a>13.3 InnoDB排他锁_窗口1</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">	排他锁：加锁的数据，不能被其他事务加锁查询或修改</span><br><span class="line">	排他锁创建格式</span><br><span class="line">		select语句 for update;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 开启事务</span><br><span class="line">start transaction;</span><br><span class="line"></span><br><span class="line">-- 查询id为1数据，并加入排他锁</span><br><span class="line">select * from student where id&#x3D;1 for update;</span><br><span class="line"></span><br><span class="line">-- 提交事务</span><br><span class="line">commit;</span><br></pre></td></tr></table></figure>



<h5 id="13-3-InnoDB排他锁-窗口2"><a href="#13-3-InnoDB排他锁-窗口2" class="headerlink" title="13.3 InnoDB排他锁_窗口2"></a>13.3 InnoDB排他锁_窗口2</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">-- 开启事务</span><br><span class="line">start transaction;</span><br><span class="line"></span><br><span class="line">-- 查询id为1数据(普通查询没问题)</span><br><span class="line">select * from student where id&#x3D;1;</span><br><span class="line"></span><br><span class="line">-- 查询id为1数据,并加入共享锁(排他锁和共享锁是不兼容的)</span><br><span class="line">select * from student where id&#x3D;1 lock in share mode; </span><br><span class="line"></span><br><span class="line">-- 查询id为1数据，并加入排他锁(排他锁和排他锁是不兼容的)</span><br><span class="line">select * from student where id&#x3D;1 for update;</span><br><span class="line"></span><br><span class="line">-- 修改id为1数据，将姓名改成张三(修改失败，会出现锁的情况。只有窗口1提交事务后才能修改成功)</span><br><span class="line">update student set name&#x3D;&#39;张三&#39; where id&#x3D;1;</span><br><span class="line"></span><br><span class="line">-- 提交事务</span><br><span class="line">commit;</span><br></pre></td></tr></table></figure>



<h5 id="13-4-MYISAM锁的数据准备"><a href="#13-4-MYISAM锁的数据准备" class="headerlink" title="13.4 MYISAM锁的数据准备"></a>13.4 MYISAM锁的数据准备</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-- 创建product表</span><br><span class="line">create table product(</span><br><span class="line">	id int primary key auto_increment,</span><br><span class="line">	name varchar(20),</span><br><span class="line">	price int</span><br><span class="line">)engine &#x3D; myisam;  -- 指定存储引擎为myisam</span><br><span class="line"></span><br><span class="line">-- 添加数据</span><br><span class="line">insert into product values (null,&#39;华为手机&#39;,4999),(null,&#39;小米手机&#39;,2999),</span><br><span class="line">(null,&#39;苹果&#39;,8999),(null,&#39;中兴&#39;,1999);</span><br></pre></td></tr></table></figure>



<h5 id="13-5-MYISAM读锁-窗口1"><a href="#13-5-MYISAM读锁-窗口1" class="headerlink" title="13.5 MYISAM读锁_窗口1"></a>13.5 MYISAM读锁_窗口1</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">	读锁：所有连接只能读取数据，不能修改</span><br><span class="line">	加锁</span><br><span class="line">		lock table 表名 read;</span><br><span class="line"></span><br><span class="line">	解锁</span><br><span class="line">		unlock tables;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 为product表添加读锁</span><br><span class="line">lock table product read;</span><br><span class="line"></span><br><span class="line">-- 查询id为1数据</span><br><span class="line">select * from product where id&#x3D;1;</span><br><span class="line"></span><br><span class="line">-- 修改id为1数据，将金额修改4999</span><br><span class="line">update product set price &#x3D; 4999 where id&#x3D;1;</span><br><span class="line"></span><br><span class="line">-- 解锁</span><br><span class="line">unlock tables;</span><br></pre></td></tr></table></figure>



<h5 id="13-5-MYISAM读锁-窗口2"><a href="#13-5-MYISAM读锁-窗口2" class="headerlink" title="13.5 MYISAM读锁_窗口2"></a>13.5 MYISAM读锁_窗口2</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- 查询id为1数据</span><br><span class="line">select * from product where id&#x3D;1;</span><br><span class="line"></span><br><span class="line">-- 修改id为1数据，将金额改成5999(修改失败，只有窗口1解锁后才能修改成功)</span><br><span class="line">update product set price&#x3D;5999 where id&#x3D;1;</span><br></pre></td></tr></table></figure>



<h5 id="13-6-MYISAM写锁-窗口1"><a href="#13-6-MYISAM写锁-窗口1" class="headerlink" title="13.6 MYISAM写锁_窗口1"></a>13.6 MYISAM写锁_窗口1</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">	写锁：其他连接不能查询和修改数据</span><br><span class="line">	加锁</span><br><span class="line">		lock table 表名 write;</span><br><span class="line"></span><br><span class="line">	解锁</span><br><span class="line">		unlock tables;</span><br><span class="line">*&#x2F;</span><br><span class="line">-- 为product表添加写锁</span><br><span class="line">lock table product write;</span><br><span class="line"></span><br><span class="line">-- 查询</span><br><span class="line">select * from product;</span><br><span class="line"></span><br><span class="line">-- 修改</span><br><span class="line">update product set price&#x3D;1999 where id&#x3D;2;</span><br><span class="line"></span><br><span class="line">-- 解锁</span><br><span class="line">unlock tables;</span><br></pre></td></tr></table></figure>



<h5 id="13-6-MYISAM写锁-窗口2"><a href="#13-6-MYISAM写锁-窗口2" class="headerlink" title="13.6 MYISAM写锁_窗口2"></a>13.6 MYISAM写锁_窗口2</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> -- 查询(查询失败，只有窗口1解锁后才能查询成功)</span><br><span class="line">select * from product;</span><br><span class="line"></span><br><span class="line">-- 修改(修改失败，只有窗口1解锁后才能修改成功)</span><br><span class="line">update product set price&#x3D;2999 where id&#x3D;2;</span><br></pre></td></tr></table></figure>



<h5 id="13-7-乐观锁"><a href="#13-7-乐观锁" class="headerlink" title="13.7 乐观锁"></a>13.7 乐观锁</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">-- 创建city表</span><br><span class="line">create table city(</span><br><span class="line">	id int primary key auto_increment,  -- 城市id</span><br><span class="line">	name varchar(20),                   -- 城市名称</span><br><span class="line">	version int                         -- 版本号</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 添加数据</span><br><span class="line">insert into city values (null,&#39;北京&#39;,1),(null,&#39;上海&#39;,1),(null,&#39;广州&#39;,1),(null,&#39;深圳&#39;,1);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 将北京修改为北京市</span><br><span class="line">-- 1.将北京的版本号读取出来</span><br><span class="line">select version from city where name&#x3D;&#39;北京&#39;;   -- 1</span><br><span class="line">-- 2.修改北京为北京市，版本号+1.并对比版本号是否相同</span><br><span class="line">update city set name&#x3D;&#39;北京市&#39;,version&#x3D;version+1 where name&#x3D;&#39;北京&#39; and version&#x3D;1;</span><br></pre></td></tr></table></figure>

<h4 id><a href="#" class="headerlink" title></a></h4> 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        分享
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="ri-weibo-fill"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="ri-wechat-fill"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="ri-qq-fill"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="ri-douban-line"></i>
          </a>
          <!-- <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a> -->
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=http://example.com/2020/10/07/mysql/Mysql%E8%AF%AD%E5%8F%A5/" alt="微信分享二维码">
    </div>
</div>

<div id="share-mask"></div>  
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/" rel="tag">mysql</a></li></ul>

    </footer>
  </div>

   
  <nav class="article-nav">
    
      <a href="/2020/10/07/maven/%E5%B8%B8%E7%94%A8maven%E4%BE%9D%E8%B5%96/" class="article-nav-link">
        <strong class="article-nav-caption">上一篇</strong>
        <div class="article-nav-title">
          
            常用maven依赖
          
        </div>
      </a>
    
    
      <a href="/2020/10/04/POI%20%E8%AF%BB%E5%86%99%E6%95%B0%E6%8D%AE/" class="article-nav-link">
        <strong class="article-nav-caption">下一篇</strong>
        <div class="article-nav-title">POI入门</div>
      </a>
    
  </nav>

  
     
</article>

</section>
      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2018-2020
        <i class="ri-heart-fill heart_icon"></i> WangYinggang
      </li>
    </ul>
    
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
      </li>
    </ul>
  </div>
</footer>
      <div class="float_btns">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

      </div>
    </main>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt="WinGone&#39;s Blog"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">关于</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <script>
      if (window.matchMedia("(max-width: 768px)").matches) {
        document.querySelector('.content').classList.remove('on');
        document.querySelector('.sidebar').classList.remove('on');
      }
    </script>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="/images/1.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/2.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->


<script src="/js/tocbot.min.js"></script>

<script>
  tocbot.init({
    tocSelector: '.tocbot',
    contentSelector: '.article-entry',
    headingSelector: 'h1, h2, h3, h4, h5, h6',
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: 'main',
    positionFixedSelector: '.tocbot',
    positionFixedClass: 'is-position-fixed',
    fixedSidebarOffset: 'auto'
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script>

<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->

<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->


<link rel="stylesheet" href="/css/clipboard.css">

<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>


<!-- CanvasBackground -->


<script src="/js/dz.js"></script>



    
    <div id="music">
    
    
    
    <iframe frameborder="no" border="1" marginwidth="0" marginheight="0" width="200" height="52"
        src="//music.163.com/outchain/player?type=2&id=36897723&auto=1&height=32"></iframe>
</div>

<style>
    #music {
        position: fixed;
        right: 15px;
        bottom: 0;
        z-index: 998;
    }
</style>
    
  </div>
</body>

</html>